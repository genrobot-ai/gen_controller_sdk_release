#!/usr/bin/env python3
# 混淆的das_protocol模块
import sys
import os
import base64

_script_dir = os.path.dirname(os.path.abspath(__file__))
if _script_dir not in sys.path:
  sys.path.insert(0, _script_dir)

ENCODED_SOURCE = '''
aW1wb3J0IHN0cnVjdApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgVHVwbGUsIE9wdGlvbmFsLCBEaWN0LCBBbnkKaW1wb3J0IGxvZ2dpbmcKaW1wb3J0IHRocmVhZGluZwoKCmNsYXNzIERBU1Byb3RvY29sOgogICAgTUFHSUMgPSBiImRhc1xyXG4iCiAgICBNQUdJQ19MRU5HVEggPSBsZW4oTUFHSUMpCgogICAgTUFYX1BBQ0tFVF9TSVpFID0gNDA5NiAgIyDmnIDlpKfmlbDmja7ljIXlpKflsI8KICAgIE1BWF9CVUZGRVJfU0laRSA9IDgxOTIgICMg5pyA5aSn57yT5Yay5Yy65aSn5bCPCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYubG9nZ2VyID0gbG9nZ2luZy5nZXRMb2dnZXIoIkRBU1Byb3RvY29sIikKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmaW5kX3BhY2tldChjbHMsIGRhdGE6IGJ5dGVzKSAtPiBUdXBsZVtMaXN0W2J5dGVzXSwgYnl0ZXNdOgogICAgICAgIHBhY2tldHMgPSBbXQogICAgICAgIGJ1ZmZlciA9IGRhdGEKCiAgICAgICAgaWYgbGVuKGJ1ZmZlcikgPiBjbHMuTUFYX0JVRkZFUl9TSVpFOgogICAgICAgICAgICBjbHMuX2xvZ193YXJuaW5nKGYi57yT5Yay5Yy66L+H5aSnOiB7bGVuKGJ1ZmZlcil95a2X6IqC77yM5riF56m657yT5Yay5Yy6IikKICAgICAgICAgICAgcmV0dXJuIFtdLCBiIiIKCiAgICAgICAgc2VhcmNoX3N0YXJ0ID0gMAogICAgICAgIHByb2Nlc3NlZF9jb3VudCA9IDAKCiAgICAgICAgd2hpbGUgbGVuKGJ1ZmZlcikgLSBzZWFyY2hfc3RhcnQgPj0gY2xzLk1BR0lDX0xFTkdUSCAqIDI6CiAgICAgICAgICAgIHByb2Nlc3NlZF9jb3VudCArPSAxCiAgICAgICAgICAgIGlmIHByb2Nlc3NlZF9jb3VudCA+IDEwMDA6CiAgICAgICAgICAgICAgICBjbHMuX2xvZ193YXJuaW5nKCLmo4DmtYvliLDlj6/og73nmoTml6DpmZDlvqrnjq/vvIzpgIDlh7rlpITnkIYiKQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICMg5p+l5om+5YyF5aS0CiAgICAgICAgICAgIGhlYWRlcl9wb3MgPSBidWZmZXIuZmluZChjbHMuTUFHSUMsIHNlYXJjaF9zdGFydCkKICAgICAgICAgICAgaWYgaGVhZGVyX3BvcyA9PSAtMToKICAgICAgICAgICAgICAgIHJlbWFpbmluZ19kYXRhID0gYnVmZmVyW3NlYXJjaF9zdGFydDpdCiAgICAgICAgICAgICAgICBjbHMuX2xvZ193YXJuaW5nKCJub3QgZm91bmQgaGVhZGVyIGZyb20gaW5kZXg6IHt9Ii5mb3JtYXQoc2VhcmNoX3N0YXJ0KSkKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAjIOajgOafpeaYr+WQpui/nue7rW1hZ2ljCiAgICAgICAgICAgIG5leHRfbWFnaWNfcG9zID0gYnVmZmVyLmZpbmQoY2xzLk1BR0lDLCBoZWFkZXJfcG9zICsgY2xzLk1BR0lDX0xFTkdUSCkKICAgICAgICAgICAgaWYgbmV4dF9tYWdpY19wb3MgPT0gaGVhZGVyX3BvcyArIGNscy5NQUdJQ19MRU5HVEg6CiAgICAgICAgICAgICAgICAjIOWPkeeOsOi/nue7rW1hZ2ljOiBkYXNcclxuZGFzXHJcbi4uLgogICAgICAgICAgICAgICAgY2xzLl9sb2dfd2FybmluZyhmIuWPkeeOsOi/nue7rW1hZ2lj77yM5L2N572uOiB7aGVhZGVyX3Bvc30iKQogICAgICAgICAgICAgICAgc2VhcmNoX3N0YXJ0ID0gaGVhZGVyX3BvcyArIGNscy5NQUdJQ19MRU5HVEggICMg6Lez6L+H56ys5LiA5LiqbWFnaWMKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjIOajgOafpeWMheWktOS9jee9ruaYr+WQpuWQiOeQhgogICAgICAgICAgICBpZiBoZWFkZXJfcG9zID4gbGVuKGJ1ZmZlcikgLSBjbHMuTUFHSUNfTEVOR1RIICogMjoKICAgICAgICAgICAgICAgIGNscy5fbG9nX3dhcm5pbmcoZiLljIXlpLTkvY3nva7lvILluLg6IHtoZWFkZXJfcG9zfSIpCiAgICAgICAgICAgICAgICByZW1haW5pbmdfZGF0YSA9IGJ1ZmZlcltzZWFyY2hfc3RhcnQ6XQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgIGZvb3Rlcl9zZWFyY2hfc3RhcnQgPSBoZWFkZXJfcG9zICsgY2xzLk1BR0lDX0xFTkdUSAogICAgICAgICAgICBmb290ZXJfcG9zID0gYnVmZmVyLmZpbmQoY2xzLk1BR0lDLCBmb290ZXJfc2VhcmNoX3N0YXJ0KQogICAgICAgICAgICBpZiBmb290ZXJfcG9zID09IC0xOgogICAgICAgICAgICAgICAgcmVtYWluaW5nX2RhdGEgPSBidWZmZXJbaGVhZGVyX3BvczpdCiAgICAgICAgICAgICAgICBjbHMuX2xvZ19pbmZvKAogICAgICAgICAgICAgICAgICAgICJub3QgZm91bmQgZm9vdGVyIGZyb20gaW5kZXg6IHt9Ii5mb3JtYXQoZm9vdGVyX3NlYXJjaF9zdGFydCkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBpZiBmb290ZXJfcG9zID4gbGVuKGJ1ZmZlcikgLSBjbHMuTUFHSUNfTEVOR1RIOgogICAgICAgICAgICAgICAgY2xzLl9sb2dfd2FybmluZygKICAgICAgICAgICAgICAgICAgICBmIuWMheWwvuS9jee9ruW8guW4uDoge2Zvb3Rlcl9wb3N9LCBmb290ZXJfcG9zOntmb290ZXJfcG9zfSwgbGVuIGJ1ZmZlcjp7bGVuKGJ1ZmZlcil9IgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgcmVtYWluaW5nX2RhdGEgPSBidWZmZXJbaGVhZGVyX3BvczpdCiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgbmV4dF9hZnRlcl9mb290ZXIgPSBmb290ZXJfcG9zICsgY2xzLk1BR0lDX0xFTkdUSAogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBuZXh0X2FmdGVyX2Zvb3RlciA8IGxlbihidWZmZXIpCiAgICAgICAgICAgICAgICBhbmQgYnVmZmVyLmZpbmQoY2xzLk1BR0lDLCBuZXh0X2FmdGVyX2Zvb3RlcikgPT0gbmV4dF9hZnRlcl9mb290ZXIKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIGNscy5fbG9nX3dhcm5pbmcoIuWPkeeOsOi/nue7reWMheWwvm1hZ2lj77yM5Y+v6IO955qE5pWw5o2u5YyF57KY6L+eIikKCiAgICAgICAgICAgIHBhY2tldF9lbmQgPSBmb290ZXJfcG9zICsgY2xzLk1BR0lDX0xFTkdUSAogICAgICAgICAgICBmdWxsX3BhY2tldCA9IGJ1ZmZlcltoZWFkZXJfcG9zOnBhY2tldF9lbmRdCgogICAgICAgICAgICBpZiBsZW4oZnVsbF9wYWNrZXQpID4gY2xzLk1BWF9QQUNLRVRfU0laRToKICAgICAgICAgICAgICAgIGNscy5fbG9nX3dhcm5pbmcoZiLmlbDmja7ljIXov4flpKc6IHtsZW4oZnVsbF9wYWNrZXQpfeWtl+iKgu+8jOi3s+i/hyIpCiAgICAgICAgICAgICAgICBzZWFyY2hfc3RhcnQgPSBoZWFkZXJfcG9zICsgY2xzLk1BR0lDX0xFTkdUSAogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYgY2xzLl92YWxpZGF0ZV9wYWNrZXRfc3RydWN0dXJlKGZ1bGxfcGFja2V0KToKICAgICAgICAgICAgICAgIHBhY2tldHMuYXBwZW5kKGZ1bGxfcGFja2V0KQogICAgICAgICAgICAgICAgc2VhcmNoX3N0YXJ0ID0gcGFja2V0X2VuZAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY2xzLl9sb2dfd2FybmluZygi5peg5pWI5pWw5o2u5YyF57uT5p6E77yM6Lez6L+HIikKICAgICAgICAgICAgICAgIHNlYXJjaF9zdGFydCA9IGhlYWRlcl9wb3MgKyBjbHMuTUFHSUNfTEVOR1RICiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVtYWluaW5nX2RhdGEgPSBidWZmZXJbc2VhcmNoX3N0YXJ0Ol0KCiAgICAgICAgIyDorrDlvZXlpITnkIbnu5PmnpwKICAgICAgICBpZiBwYWNrZXRzOgogICAgICAgICAgICBjbHMuX2xvZ19kZWJ1ZygKICAgICAgICAgICAgICAgIGYi5om+5YiwIHtsZW4ocGFja2V0cyl9IOS4quaVsOaNruWMhe+8jOWJqeS9mSB7bGVuKHJlbWFpbmluZ19kYXRhKX0g5a2X6IqCIgogICAgICAgICAgICApCgogICAgICAgIHJldHVybiBwYWNrZXRzLCByZW1haW5pbmdfZGF0YQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF92YWxpZGF0ZV9wYWNrZXRfc3RydWN0dXJlKGNscywgcGFja2V0OiBieXRlcykgLT4gYm9vbDoKICAgICAgICAiIiLpqozor4HmlbDmja7ljIXnu5PmnoTmmK/lkKbmnInmlYgiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgICMg5qOA5p+l6ZW/5bqmCiAgICAgICAgICAgIGlmIGxlbihwYWNrZXQpIDwgY2xzLk1BR0lDX0xFTkdUSCAqIDI6CiAgICAgICAgICAgICAgICBjbHMuX2xvZ193YXJuaW5nKGYi5pWw5o2u5YyF6L+H55+tOiB7bGVuKHBhY2tldCl95a2X6IqCIikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICAgICAgIyDmo4Dmn6XlpLTlsL5tYWdpYwogICAgICAgICAgICBoZWFkZXIgPSBwYWNrZXRbOiBjbHMuTUFHSUNfTEVOR1RIXQogICAgICAgICAgICBmb290ZXIgPSBwYWNrZXRbLWNscy5NQUdJQ19MRU5HVEggOl0KCiAgICAgICAgICAgIGlmIGhlYWRlciAhPSBjbHMuTUFHSUM6CiAgICAgICAgICAgICAgICBjbHMuX2xvZ193YXJuaW5nKCLljIXlpLRtYWdpY+S4jeWMuemFjSIpCiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgICAgIGlmIGZvb3RlciAhPSBjbHMuTUFHSUM6CiAgICAgICAgICAgICAgICBjbHMuX2xvZ193YXJuaW5nKCLljIXlsL5tYWdpY+S4jeWMuemFjSIpCiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgICAgICMg5qOA5p+l5YaF5a656ZW/5bqmCiAgICAgICAgICAgIGNvbnRlbnQgPSBwYWNrZXRbY2xzLk1BR0lDX0xFTkdUSCA6IC1jbHMuTUFHSUNfTEVOR1RIXQogICAgICAgICAgICBpZiBsZW4oY29udGVudCkgPCAxOgogICAgICAgICAgICAgICAgY2xzLl9sb2dfd2FybmluZygi5pWw5o2u5YyF5YaF5a655Li656m6IikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICAgICAgIyDmo4Dmn6VvcGNvZGXojIPlm7QKICAgICAgICAgICAgb3Bjb2RlID0gY29udGVudFswXQogICAgICAgICAgICBpZiBvcGNvZGUgPiAweEZGOiAgIyBvcGNvZGXlupTor6XmmK8wLTI1NQogICAgICAgICAgICAgICAgY2xzLl9sb2dfd2FybmluZyhmIuaXoOaViG9wY29kZToge29wY29kZX0iKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGNscy5fbG9nX2Vycm9yKGYi5pWw5o2u5YyF57uT5p6E6aqM6K+B6ZSZ6K+vOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBwYXJzZV9wYWNrZXQoY2xzLCBwYWNrZXQ6IGJ5dGVzKSAtPiBPcHRpb25hbFtEaWN0W3N0ciwgQW55XV06CiAgICAgICAgIiIi6Kej5p6Q5pWw5o2u5YyF77yI5aKe5by66ZSZ6K+v5aSE55CG77yJIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIOWfuuehgOmqjOivgQogICAgICAgICAgICBpZiBub3QgY2xzLl92YWxpZGF0ZV9wYWNrZXRfc3RydWN0dXJlKHBhY2tldCk6CiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgICAgICAgICAgIyDmj5Dlj5bmlbDmja7lhoXlrrkKICAgICAgICAgICAgY29udGVudCA9IHBhY2tldFtjbHMuTUFHSUNfTEVOR1RIIDogLWNscy5NQUdJQ19MRU5HVEhdCgogICAgICAgICAgICAjIOino+aekG9wY29kZQogICAgICAgICAgICBvcGNvZGUgPSBjb250ZW50WzBdCgogICAgICAgICAgICAjIOaVsOaNruaute+8iG9wY29kZeS5i+WQjueahOaJgOacieaVsOaNru+8iQogICAgICAgICAgICBkYXRhX3NlY3Rpb24gPSBjb250ZW50WzE6XSBpZiBsZW4oY29udGVudCkgPiAxIGVsc2UgYiIiCgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgIm9wY29kZSI6IG9wY29kZSwKICAgICAgICAgICAgICAgICJkYXRhX3NlY3Rpb24iOiBkYXRhX3NlY3Rpb24sCiAgICAgICAgICAgICAgICAiZGF0YV9sZW5ndGgiOiBsZW4oZGF0YV9zZWN0aW9uKSwKICAgICAgICAgICAgICAgICJyYXdfcGFja2V0IjogcGFja2V0LAogICAgICAgICAgICAgICAgInBhY2tldF9sZW5ndGgiOiBsZW4ocGFja2V0KSwKICAgICAgICAgICAgICAgICJ0aW1lc3RhbXAiOiBkYXRldGltZS5ub3coKSwKICAgICAgICAgICAgfQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGNscy5fbG9nX2Vycm9yKGYi5pWw5o2u5YyF6Kej5p6Q6ZSZ6K+vOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGNyZWF0ZV9wYWNrZXQoY2xzLCBvcGNvZGU6IGludCwgZGF0YTogYnl0ZXMgPSBiIiIpIC0+IGJ5dGVzOgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3Bjb2RlLCBpbnQpIG9yIG9wY29kZSA8IDAgb3Igb3Bjb2RlID4gMjU1OgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigib3Bjb2Rl5b+F6aG75pivMC0yNTXkuYvpl7TnmoTmlbTmlbAiKQoKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0YSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZGF0YeW/hemhu+aYr2J5dGVz57G75Z6LIikKCiAgICAgICAgICAgIGlmIGxlbihkYXRhKSA+IDEwMjQ6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCLmlbDmja7plb/luqbotoXov4fpmZDliLYiKQoKICAgICAgICAgICAgcmV0dXJuIGNscy5NQUdJQyArIGJ5dGVzKFtvcGNvZGVdKSArIGRhdGEgKyBjbHMuTUFHSUMKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBjbHMuX2xvZ19lcnJvcihmIuWIm+W7uuaVsOaNruWMhemUmeivrzoge2V9IikKICAgICAgICAgICAgcmFpc2UKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfbG9nX2luZm8oY2xzLCBtZXNzYWdlOiBzdHIpOgogICAgICAgIGxvZ2dpbmcuaW5mbyhmIltEQVNQcm90b2NvbF0ge21lc3NhZ2V9IikKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfbG9nX2RlYnVnKGNscywgbWVzc2FnZTogc3RyKToKICAgICAgICBsb2dnaW5nLmRlYnVnKGYiW0RBU1Byb3RvY29sXSB7bWVzc2FnZX0iKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9sb2dfd2FybmluZyhjbHMsIG1lc3NhZ2U6IHN0cik6CiAgICAgICAgbG9nZ2luZy53YXJuaW5nKGYiW0RBU1Byb3RvY29sXSB7bWVzc2FnZX0iKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9sb2dfZXJyb3IoY2xzLCBtZXNzYWdlOiBzdHIpOgogICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJbREFTUHJvdG9jb2xdIHttZXNzYWdlfSIpCgoKY2xhc3MgREFTQ29udHJvbGxlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmJ1ZmZlciA9IGIiIgogICAgICAgIHNlbGYuYnVmZmVyX2xvY2sgPSB0aHJlYWRpbmcuTG9jaygpCiAgICAgICAgc2VsZi5lcnJvcl9jb3VudCA9IDAKICAgICAgICBzZWxmLm1heF9jb25zZWN1dGl2ZV9lcnJvcnMgPSAxMAogICAgICAgIHNlbGYuY29uc2VjdXRpdmVfZXJyb3JzID0gMAogICAgICAgIHNlbGYuc3RhdHMgPSB7CiAgICAgICAgICAgICJ0b3RhbF9wYWNrZXRzIjogMCwKICAgICAgICAgICAgInZhbGlkX3BhY2tldHMiOiAwLAogICAgICAgICAgICAiaW52YWxpZF9wYWNrZXRzIjogMCwKICAgICAgICAgICAgInJlY292ZXJlZF9wYWNrZXRzIjogMCwKICAgICAgICAgICAgImJ1ZmZlcl9yZXNldHMiOiAwLAogICAgICAgIH0KCiAgICBkZWYgcHJvY2Vzc19yZWNlaXZlZF9kYXRhKHNlbGYsIG5ld19kYXRhOiBieXRlcyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIHNlbGYuYnVmZmVyX2xvY2s6CiAgICAgICAgICAgICAgICBzZWxmLmJ1ZmZlciArPSBuZXdfZGF0YQoKICAgICAgICAgICAgICAgICMg5qOA5p+l57yT5Yay5Yy65YGl5bq35bqmCiAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5fY2hlY2tfYnVmZmVyX2hlYWx0aCgpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3Jlc2V0X2J1ZmZlcigpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICAgICAgIyDmn6Xmib7lrozmlbTmlbDmja7ljIUKICAgICAgICAgICAgICAgIHBhY2tldHMsIHJlbWFpbmluZ19kYXRhID0gREFTUHJvdG9jb2wuZmluZF9wYWNrZXQoc2VsZi5idWZmZXIpCgogICAgICAgICAgICAgICAgIyDmm7TmlrDnvJPlhrLljLoKICAgICAgICAgICAgICAgIHNlbGYuYnVmZmVyID0gcmVtYWluaW5nX2RhdGEKCiAgICAgICAgICAgICMg5aSE55CG5om+5Yiw55qE5pWw5o2u5YyFCiAgICAgICAgICAgIGZvciBwYWNrZXQgaW4gcGFja2V0czoKICAgICAgICAgICAgICAgIHNlbGYuX2hhbmRsZV9wYWNrZXRfd2l0aF9yZXRyeShwYWNrZXQpCgogICAgICAgICAgICBzZWxmLl9sb2dfd2FybmluZygiZmluZCBwYWNrZXRzIG51bToge30iLmZvcm1hdChsZW4ocGFja2V0cykpKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuX2hhbmRsZV9wcm9jZXNzaW5nX2Vycm9yKGUpCgogICAgZGVmIF9jaGVja19idWZmZXJfaGVhbHRoKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgIyDmo4Dmn6XnvJPlhrLljLrlpKflsI8KICAgICAgICBpZiBsZW4oc2VsZi5idWZmZXIpID4gREFTUHJvdG9jb2wuTUFYX0JVRkZFUl9TSVpFOgogICAgICAgICAgICBzZWxmLl9sb2dfZXJyb3IoZiLnvJPlhrLljLrov4flpKc6IHtsZW4oc2VsZi5idWZmZXIpfeWtl+iKgiIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9yZXNldF9idWZmZXIoc2VsZik6CiAgICAgICAgIiIi6YeN572u57yT5Yay5Yy6IiIiCiAgICAgICAgc2VsZi5fbG9nX3dhcm5pbmcoIumHjee9rue8k+WGsuWMuiIpCiAgICAgICAgc2VsZi5idWZmZXIgPSBiIiIKICAgICAgICBzZWxmLmNvbnNlY3V0aXZlX2Vycm9ycyA9IDAKICAgICAgICBzZWxmLnN0YXRzWyJidWZmZXJfcmVzZXRzIl0gKz0gMQoKICAgIGRlZiBfaGFuZGxlX3BhY2tldF93aXRoX3JldHJ5KHNlbGYsIHBhY2tldDogYnl0ZXMsIG1heF9yZXRyaWVzOiBpbnQgPSAzKToKICAgICAgICAiIiLluKbph43or5XnmoTmlbDmja7ljIXlpITnkIYiIiIKICAgICAgICBmb3IgYXR0ZW1wdCBpbiByYW5nZShtYXhfcmV0cmllcyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHBhcnNlZCA9IERBU1Byb3RvY29sLnBhcnNlX3BhY2tldChwYWNrZXQpCiAgICAgICAgICAgICAgICBpZiBwYXJzZWQ6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5faGFuZGxlX3ZhbGlkX3BhY2tldChwYXJzZWQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2hhbmRsZV9pbnZhbGlkX3BhY2tldChwYWNrZXQsIGF0dGVtcHQpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuX2xvZ19lcnJvcihmIuaVsOaNruWMheWkhOeQhumUmeivryAo5bCd6K+VIHthdHRlbXB0KzF9KToge2V9IikKCiAgICAgICAgc2VsZi5zdGF0c1siaW52YWxpZF9wYWNrZXRzIl0gKz0gMQoKICAgIGRlZiBfaGFuZGxlX3ZhbGlkX3BhY2tldChzZWxmLCBwYXJzZWRfcGFja2V0OiBEaWN0KToKICAgICAgICAiIiLlpITnkIbmnInmlYjmlbDmja7ljIUiIiIKICAgICAgICBzZWxmLnN0YXRzWyJ2YWxpZF9wYWNrZXRzIl0gKz0gMQogICAgICAgIHNlbGYuc3RhdHNbInRvdGFsX3BhY2tldHMiXSArPSAxCgogICAgICAgIHByaW50KAogICAgICAgICAgICBmIlt7cGFyc2VkX3BhY2tldFsndGltZXN0YW1wJ10uc3RyZnRpbWUoJyVIOiVNOiVTLiVmJyl9XSAiCiAgICAgICAgICAgIGYi5pyJ5pWI5pWw5o2u5YyFIC0gT1BDT0RFOiAweHtwYXJzZWRfcGFja2V0WydvcGNvZGUnXTowMlh9LCAiCiAgICAgICAgICAgIGYi5pWw5o2u6ZW/5bqmOiB7cGFyc2VkX3BhY2tldFsnZGF0YV9sZW5ndGgnXX0iCiAgICAgICAgKQoKICAgICAgICAjIOagueaNrm9wY29kZeWIhuWPkeWkhOeQhgogICAgICAgIHNlbGYuX2Rpc3BhdGNoX2J5X29wY29kZShwYXJzZWRfcGFja2V0WyJvcGNvZGUiXSwgcGFyc2VkX3BhY2tldFsiZGF0YV9zZWN0aW9uIl0pCgogICAgZGVmIF9oYW5kbGVfaW52YWxpZF9wYWNrZXQoc2VsZiwgcGFja2V0OiBieXRlcywgYXR0ZW1wdDogaW50KToKICAgICAgICBzZWxmLl9sb2dfd2FybmluZyhmIuaXoOaViOaVsOaNruWMhSAo5bCd6K+VIHthdHRlbXB0KzF9KTog6ZW/5bqmPXtsZW4ocGFja2V0KX3lrZfoioIiKQoKICAgICAgICAjIOiusOW9leaXoOaViOWMheWGheWuue+8iOeUqOS6juiwg+ivle+8iQogICAgICAgIGlmIGF0dGVtcHQgPT0gMDogICMg5Y+q5Zyo56ys5LiA5qyh5bCd6K+V5pe26K6w5b2VCiAgICAgICAgICAgIHNlbGYuX2xvZ19kZWJ1ZyhmIuaXoOaViOWMheWGheWuuToge3BhY2tldC5oZXgoKVs6MTAwXX0uLi4iKQoKICAgIGRlZiBfaGFuZGxlX3Byb2Nlc3NpbmdfZXJyb3Ioc2VsZiwgZXJyb3I6IEV4Y2VwdGlvbik6CiAgICAgICAgIiIi5aSE55CG5aSE55CG6L+H56iL5Lit55qE6ZSZ6K+vIiIiCiAgICAgICAgc2VsZi5lcnJvcl9jb3VudCArPSAxCiAgICAgICAgc2VsZi5jb25zZWN1dGl2ZV9lcnJvcnMgKz0gMQoKICAgICAgICBzZWxmLl9sb2dfZXJyb3IoZiLmlbDmja7lpITnkIbplJnor686IHtlcnJvcn0iKQoKICAgICAgICAjIOWmguaenOmUmeivr+i/h+Wkmu+8jOiAg+iZkemHjee9rgogICAgICAgIGlmIHNlbGYuY29uc2VjdXRpdmVfZXJyb3JzID49IHNlbGYubWF4X2NvbnNlY3V0aXZlX2Vycm9yczoKICAgICAgICAgICAgc2VsZi5fbG9nX2Vycm9yKCLplJnor6/ov4flpJrvvIzmiafooYzmgaLlpI3mk43kvZwiKQogICAgICAgICAgICBzZWxmLl9yZXNldF9idWZmZXIoKQoKICAgIGRlZiBfZGlzcGF0Y2hfYnlfb3Bjb2RlKHNlbGYsIG9wY29kZTogaW50LCBkYXRhOiBieXRlcyk6CiAgICAgICAgIiIi5qC55o2ub3Bjb2Rl5YiG5Y+R5aSE55CGIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBvcGNvZGUgPT0gMHgwMToKICAgICAgICAgICAgICAgIHNlbGYuX2hhbmRsZV9zZW5zb3JfZGF0YShkYXRhKQogICAgICAgICAgICBlbGlmIG9wY29kZSA9PSAweDAyOgogICAgICAgICAgICAgICAgc2VsZi5faGFuZGxlX2NvbmZpZ19kYXRhKGRhdGEpCiAgICAgICAgICAgIGVsaWYgb3Bjb2RlID09IDB4MDM6CiAgICAgICAgICAgICAgICBzZWxmLl9oYW5kbGVfc3RhdHVzX2RhdGEoZGF0YSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX2xvZ193YXJuaW5nKGYi5pyq55+lT1BDT0RFOiAweHtvcGNvZGU6MDJYfSIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLl9sb2dfZXJyb3IoZiJPUENPREXlpITnkIbplJnor686IHtlfSIpCgogICAgZGVmIF9oYW5kbGVfc2Vuc29yX2RhdGEoc2VsZiwgZGF0YTogYnl0ZXMpOgogICAgICAgICIiIuWkhOeQhuS8oOaEn+WZqOaVsOaNriIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgIyDop6PmnpDkvKDmhJ/lmajmlbDmja4KICAgICAgICAgICAgaWYgbGVuKGRhdGEpID49IDQ6CiAgICAgICAgICAgICAgICAjIOekuuS+i++8muino+aekOaXtumXtOaIs+WSjOaVsOaNruWAvAogICAgICAgICAgICAgICAgdGltZXN0YW1wID0gaW50LmZyb21fYnl0ZXMoZGF0YVs6NF0sICJsaXR0bGUiKQogICAgICAgICAgICAgICAgc2Vuc29yX3ZhbHVlID0gZGF0YVs0Ol0gaWYgbGVuKGRhdGEpID4gNCBlbHNlIGIiIgogICAgICAgICAgICAgICAgcHJpbnQoZiLkvKDmhJ/lmajmlbDmja4gLSDml7bpl7TmiLM6IHt0aW1lc3RhbXB9LCDlgLw6IHtzZW5zb3JfdmFsdWUuaGV4KCl9IikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuX2xvZ19lcnJvcihmIuS8oOaEn+WZqOaVsOaNruWkhOeQhumUmeivrzoge2V9IikKCiAgICBkZWYgX2hhbmRsZV9jb25maWdfZGF0YShzZWxmLCBkYXRhOiBieXRlcyk6CiAgICAgICAgcHJpbnQoIuWkhOeQhumFjee9ruaVsOaNriIpCgogICAgZGVmIF9oYW5kbGVfc3RhdHVzX2RhdGEoc2VsZiwgZGF0YTogYnl0ZXMpOgogICAgICAgIHByaW50KCLlpITnkIbnirbmgIHmlbDmja4iKQoKICAgIGRlZiBnZXRfc3RhdGlzdGljcyhzZWxmKSAtPiBEaWN0OgogICAgICAgIHJldHVybiBzZWxmLnN0YXRzLmNvcHkoKQoKICAgIGRlZiBfbG9nX2luZm8oc2VsZiwgbWVzc2FnZTogc3RyKToKICAgICAgICBsb2dnaW5nLmluZm8oZiJbREFTQ29udHJvbGxlcl0ge21lc3NhZ2V9IikKCiAgICBkZWYgX2xvZ19kZWJ1ZyhzZWxmLCBtZXNzYWdlOiBzdHIpOgogICAgICAgIGxvZ2dpbmcuZGVidWcoZiJbREFTQ29udHJvbGxlcl0ge21lc3NhZ2V9IikKCiAgICBkZWYgX2xvZ193YXJuaW5nKHNlbGYsIG1lc3NhZ2U6IHN0cik6CiAgICAgICAgbG9nZ2luZy53YXJuaW5nKGYiW0RBU0NvbnRyb2xsZXJdIHttZXNzYWdlfSIpCgogICAgZGVmIF9sb2dfZXJyb3Ioc2VsZiwgbWVzc2FnZTogc3RyKToKICAgICAgICBsb2dnaW5nLmVycm9yKGYiW0RBU0NvbnRyb2xsZXJdIHttZXNzYWdlfSIpCgoKIyDmtYvor5Xlh73mlbAKZGVmIHRlc3RfZXJyb3JfaGFuZGxpbmcoKToKICAgIHByaW50KCI9PT0gREFT5Y2P6K6u6ZSZ6K+v5aSE55CG5rWL6K+VID09PSIpCgogICAgIyDphY3nva7ml6Xlv5cKICAgIGxvZ2dpbmcuYmFzaWNDb25maWcoCiAgICAgICAgbGV2ZWw9bG9nZ2luZy5ERUJVRywgZm9ybWF0PSIlKGFzY3RpbWUpcyAtICUobGV2ZWxuYW1lKXMgLSAlKG1lc3NhZ2UpcyIKICAgICkKCiAgICBjb250cm9sbGVyID0gREFTQ29udHJvbGxlcigpCgogICAgIyDmtYvor5XnlKjkvovvvJrlkITnp43lvILluLjmlbDmja4KICAgIHRlc3RfY2FzZXMgPSBbCiAgICAgICAgIyDmraPluLjmlbDmja7ljIUKICAgICAgICAjIGIiZGFzXHJcbiIgKyBEQVNQcm90b2NvbC5jcmVhdGVfcGFja2V0KDB4MDEsIGIibm9ybWFsX2RhdGEiKSwKICAgICAgICAjIOaNn+Wdj+eahOaVsOaNruWMhQogICAgICAgICMgYiJkYXNcclxuXHgwMWNvcnJ1cHRlZF9kYXRhIiwgICMg57y65bCR5YyF5bC+CiAgICAgICAgIyBiImRhc1xyXG5ceDAyIiArIGIieCIgKiA1MDAwLCAgIyDmlbDmja7ov4fplb8KICAgICAgICAjIGIiaW52YWxpZF9tYWdpY1x4MDFkYXRhIiwgICMg6ZSZ6K+v55qEbWFnaWMKICAgICAgICAjIGIiZGFzXHJcblx4ZmYiICsgYiJ4IiAqIDEwMDAsICAjIOaXoOaViG9wY29kZQogICAgICAgICMgIyDmt7flkIjmlbDmja4KICAgICAgICBEQVNQcm90b2NvbC5jcmVhdGVfcGFja2V0KDB4MDIsIGIiZ29vZF9kYXRhIikKICAgICAgICArIGIiZ2FyYmFnZSIKICAgICAgICArIERBU1Byb3RvY29sLmNyZWF0ZV9wYWNrZXQoMHgwMywgYiJlbmRfZGF0YSIpCiAgICAgICAgIyArIGIieCIgKiAxMDAwMAogICAgXQoKICAgIGZvciBpLCB0ZXN0X2RhdGEgaW4gZW51bWVyYXRlKHRlc3RfY2FzZXMpOgogICAgICAgIHByaW50KGYiXG4tLS0g5rWL6K+V55So5L6LIHtpKzF9IC0tLSIpCiAgICAgICAgcHJpbnQoZiLovpPlhaXmlbDmja7plb/luqY6IHtsZW4odGVzdF9kYXRhKX3lrZfoioIiKQoKICAgICAgICBjb250cm9sbGVyLnByb2Nlc3NfcmVjZWl2ZWRfZGF0YSh0ZXN0X2RhdGEpCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIHRlc3RfZXJyb3JfaGFuZGxpbmcoKQo=
'''

try:
  source_code = base64.b64decode(ENCODED_SOURCE).decode('utf-8')
  code = compile(source_code, 'das_protocol.py', 'exec')
  
  import builtins
  globals_dict = {
    '__name__': '__main__',
    '__file__': __file__,
    '__package__': None,
    '__builtins__': builtins,
  }
  
  exec(code, globals_dict)
  
  for key, value in globals_dict.items():
    if not key.startswith('_'):
      globals()[key] = value
except Exception as e:
  print(f"das_protocol模块解码错误: {e}")
  raise

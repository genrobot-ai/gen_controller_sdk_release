#!/usr/bin/env python3
# 混淆的相机节点
import sys
import os

# 设置路径
_script_dir = os.path.dirname(os.path.abspath(__file__))
if _script_dir not in sys.path:
    sys.path.insert(0, _script_dir)

# 原始代码（Base64编码）
import base64
import marshal
import types

# 编码的源码
ENCODED_SOURCE = '''
IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIOWcqOaWh+S7tuW8gOWktOa3u+WKoOi3r+W+hOWkhOeQhgppbXBvcnQgc3lzCmltcG9ydCBvcwoKIyDoh6rliqjmt7vliqDohJrmnKznm67lvZXliLBQeXRob27ot6/lvoQKc2NyaXB0X2RpciA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQppZiBzY3JpcHRfZGlyIG5vdCBpbiBzeXMucGF0aDoKICAgIHN5cy5wYXRoLmluc2VydCgwLCBzY3JpcHRfZGlyKQoKaW1wb3J0IGN2MgppbXBvcnQgb3MKaW1wb3J0IHRpbWUKaW1wb3J0IGdsb2IKaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IHNpZ25hbAppbXBvcnQgc3lzCmltcG9ydCByb3NweQppbXBvcnQgbnVtcHkgYXMgbnAgICMg5re75YqgIG51bXB5IOWvvOWFpQpmcm9tIHNlbnNvcl9tc2dzLm1zZyBpbXBvcnQgSW1hZ2UsIENvbXByZXNzZWRJbWFnZQpmcm9tIGN2X2JyaWRnZSBpbXBvcnQgQ3ZCcmlkZ2UKaW1wb3J0IHRocmVhZGluZwpmcm9tIHN0ZF9tc2dzLm1zZyBpbXBvcnQgSGVhZGVyCgpjbGFzcyBDYW1lcmFDYXB0dXJlUk9TOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgICMg5YWI5Yid5aeL5YyWUk9T6IqC54K5CiAgICAgICAgdHJ5OgogICAgICAgICAgICByb3NweS5pbml0X25vZGUoJ2NhbWVyYV9jYXB0dXJlX25vZGUnLCBhbm9ueW1vdXM9VHJ1ZSkKICAgICAgICBleGNlcHQgcm9zcHkuZXhjZXB0aW9ucy5ST1NFeGNlcHRpb246CiAgICAgICAgICAgICMg5aaC5p6c5bey57uP5Yid5aeL5YyW77yM5Y+q6I635Y+W6IqC54K55ZCNCiAgICAgICAgICAgIHBhc3MKICAgICAgICAKICAgICAgICAjIOeEtuWQjuS7jlJPU+WPguaVsOiOt+WPlumFjee9rgogICAgICAgIHNlbGYuX2xvYWRfcm9zX3BhcmFtcygpCiAgICAgICAgCiAgICAgICAgIyDkvb/nlKjoioLngrnlkI3kvZzkuLrllK/kuIDmoIfor4YKICAgICAgICBzZWxmLm5vZGVfbmFtZSA9IHJvc3B5LmdldF9uYW1lKCkucmVwbGFjZSgnLycsICdfJykKICAgICAgICBpZiBzZWxmLm5vZGVfbmFtZSA9PSAnX3VubmFtZWQnOgogICAgICAgICAgICBzZWxmLm5vZGVfbmFtZSA9ICdjYW1lcmFfZGVmYXVsdCcKICAgICAgICAKICAgICAgICByb3NweS5sb2dpbmZvKGYi6IqC54K55qCH6K+GOiB7c2VsZi5ub2RlX25hbWV9IikKICAgICAgICAKICAgICAgICBzZWxmLmNhbWVyYXMgPSBbXQogICAgICAgIHNlbGYucnVubmluZyA9IFRydWUKICAgICAgICAKICAgICAgICAjIOaaguaXtuS4jeS9v+eUqCBDdkJyaWRnZe+8jOmBv+WFjSBsaWJmZmkg6Zeu6aKYCiAgICAgICAgIyBzZWxmLmJyaWRnZSA9IEN2QnJpZGdlKCkKICAgICAgICAKICAgICAgICBzZWxmLmltYWdlX3B1Ymxpc2hlcnMgPSBbXQogICAgICAgIAogICAgICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgc2VsZi5fc2lnbmFsX2hhbmRsZXIpCiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHVEVSTSwgc2VsZi5fc2lnbmFsX2hhbmRsZXIpCiAgICAgICAgCiAgICAgICAgc2VsZi5faW5pdF9jYW1lcmFzKCkKICAgICAgICBzZWxmLl9pbml0X3Jvc19wdWJsaXNoZXJzKCkKCiAgICBkZWYgX2xvYWRfcm9zX3BhcmFtcyhzZWxmKToKICAgICAgICAiIiLku45ST1Plj4LmlbDmnI3liqHlmajliqDovb3phY3nva4iIiIKICAgICAgICAjIOm7mOiupOWPguaVsAogICAgICAgIHNlbGYuc2hvd19wcmV2aWV3ID0gcm9zcHkuZ2V0X3BhcmFtKCd+c2hvd19wcmV2aWV3JywgVHJ1ZSkKICAgICAgICAKICAgICAgICAjIOino+aekOWIhui+qOeOh+WPguaVsAogICAgICAgIHJlc29sdXRpb25zX3N0ciA9IHJvc3B5LmdldF9wYXJhbSgnfnJlc29sdXRpb25zJywgIjY0MHg0ODAsMzIweDI0MCw4MDB4NjAwIikKICAgICAgICBzZWxmLnJlc29sdXRpb25zID0gW10KICAgICAgICBmb3IgcmVzX3N0ciBpbiByZXNvbHV0aW9uc19zdHIuc3BsaXQoJywnKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgd2lkdGgsIGhlaWdodCA9IG1hcChpbnQsIHJlc19zdHIuc3RyaXAoKS5zcGxpdCgneCcpKQogICAgICAgICAgICAgICAgc2VsZi5yZXNvbHV0aW9ucy5hcHBlbmQoKHdpZHRoLCBoZWlnaHQpKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICByb3NweS5sb2d3YXJuKGYi5peg5rOV6Kej5p6Q5YiG6L6o546H5a2X56ym5LiyOiB7cmVzX3N0cn0iKQogICAgICAgIAogICAgICAgICMg5aaC5p6c5rKh5pyJ6Kej5p6Q5Yiw5pyJ5pWI55qE5YiG6L6o546H77yM5L2/55So6buY6K6k5YC8CiAgICAgICAgaWYgbm90IHNlbGYucmVzb2x1dGlvbnM6CiAgICAgICAgICAgIHNlbGYucmVzb2x1dGlvbnMgPSBbKDY0MCwgNDgwKSwgKDMyMCwgMjQwKSwgKDgwMCwgNjAwKV0KICAgICAgICAKICAgICAgICAjIHRvcGlj5Z+656GA5ZCN56ewCiAgICAgICAgc2VsZi50b3BpY19iYXNlID0gcm9zcHkuZ2V0X3BhcmFtKCd+dG9waWNfYmFzZScsICcvY2FtZXJhX2Zpc2hleWUnKQogICAgICAgIAogICAgICAgICMg55u45py65pWw6YeP6ZmQ5Yi2CiAgICAgICAgc2VsZi5tYXhfY2FtZXJhcyA9IHJvc3B5LmdldF9wYXJhbSgnfmNhbWVyYV9jb3VudCcsIDMpCiAgICAgICAgCiAgICAgICAgIyDojrflj5bphY3nva7nmoRVU0Lnq6/lj6MKICAgICAgICBzZWxmLnVzYl9wb3J0ID0gcm9zcHkuZ2V0X3BhcmFtKCd+dXNiX3BvcnQnLCAnJykKCiAgICAgICAgc2VsZi52aWRlbzBfbWFpbiA9IHJvc3B5LmdldF9wYXJhbSgnfnZpZGVvXzBfbWFpbicsICcnKQogICAgICAgIHNlbGYudmlkZW8wX3NlYyA9IHJvc3B5LmdldF9wYXJhbSgnfnZpZGVvXzBfc2VjJywgJycpCiAgICAgICAgc2VsZi52aWRlbzFfbWFpbiA9IHJvc3B5LmdldF9wYXJhbSgnfnZpZGVvXzFfbWFpbicsICcnKQogICAgICAgIHNlbGYudmlkZW8xX3NlYyA9IHJvc3B5LmdldF9wYXJhbSgnfnZpZGVvXzFfc2VjJywgJycpCiAgICAgICAgc2VsZi52aWRlbzJfbWFpbiA9IHJvc3B5LmdldF9wYXJhbSgnfnZpZGVvXzJfbWFpbicsICcnKQogICAgICAgIHNlbGYudmlkZW8yX3NlYyA9IHJvc3B5LmdldF9wYXJhbSgnfnZpZGVvXzJfc2VjJywgJycpCiAgICAgICAgCiAgICAgICAgcm9zcHkubG9naW5mbyhmIuebuOacuumFjee9ruWKoOi9veWujOaIkDoiKQogICAgICAgIHJvc3B5LmxvZ2luZm8oZiIgIC0g6IqC54K55ZCNOiB7cm9zcHkuZ2V0X25hbWUoKX0iKQogICAgICAgIHJvc3B5LmxvZ2luZm8oZiIgIC0g5pi+56S66aKE6KeIOiB7c2VsZi5zaG93X3ByZXZpZXd9IikKICAgICAgICByb3NweS5sb2dpbmZvKGYiICAtIOWIhui+qOeOh+WIl+ihqDoge3NlbGYucmVzb2x1dGlvbnN9IikKICAgICAgICByb3NweS5sb2dpbmZvKGYiICAtIFRvcGlj5Z+656GAOiB7c2VsZi50b3BpY19iYXNlfSIpCiAgICAgICAgcm9zcHkubG9naW5mbyhmIiAgLSDmnIDlpKfnm7jmnLrmlbA6IHtzZWxmLm1heF9jYW1lcmFzfSIpCiAgICAgICAgcm9zcHkubG9naW5mbyhmIiAgLSBVU0Lnq6/lj6M6IHtzZWxmLnVzYl9wb3J0fSIpCiAgICAgICAgcm9zcHkubG9naW5mbyhmIiAgLSB2aWRlbzBfbWFpbjoge3NlbGYudmlkZW8wX21haW59IikKICAgICAgICByb3NweS5sb2dpbmZvKGYiICAtIHZpZGVvMF9zZWM6IHtzZWxmLnZpZGVvMF9zZWN9IikKICAgICAgICByb3NweS5sb2dpbmZvKGYiICAtIHZpZGVvMV9tYWluOiB7c2VsZi52aWRlbzFfbWFpbn0iKQogICAgICAgIHJvc3B5LmxvZ2luZm8oZiIgIC0gdmlkZW8xX3NlYzoge3NlbGYudmlkZW8xX3NlY30iKQogICAgICAgIHJvc3B5LmxvZ2luZm8oZiIgIC0gdmlkZW8yX21haW46IHtzZWxmLnZpZGVvMl9tYWlufSIpCiAgICAgICAgcm9zcHkubG9naW5mbyhmIiAgLSB2aWRlbzJfc2VjOiB7c2VsZi52aWRlbzJfc2VjfSIpCgogICAgZGVmIF9zaWduYWxfaGFuZGxlcihzZWxmLCBzaWdudW0sIGZyYW1lKToKICAgICAgICByb3NweS5sb2dpbmZvKGYiXG7mjqXmlLbliLDnu4jmraLkv6Hlj7coe3NpZ251bX0p77yM5q2j5Zyo5YGc5q2i6YeH6ZuGLi4uIikKICAgICAgICBzZWxmLnJ1bm5pbmcgPSBGYWxzZQogICAgICAgIHJvc3B5LnNpZ25hbF9zaHV0ZG93bigiVXNlciByZXF1ZXN0ZWQgc2h1dGRvd24iKQoKICAgIGRlZiBfZ2V0X3BoeXNpY2FsX2RldmljZXMoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihbJ3Y0bDItY3RsJywgJy0tbGlzdC1kZXZpY2VzJ10sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCiAgICAgICAgICAgIGRldmljZXMgPSBbXQogICAgICAgICAgICBjdXJyZW50X2RldiA9ICIiCiAgICAgICAgICAgIGRldmljZV9uYW1lcyA9IHt9CiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgbGluZSBpbiByZXN1bHQuc3Rkb3V0LnNwbGl0KCdcbicpOgogICAgICAgICAgICAgICAgaWYgbm90IGxpbmUuc3RyaXAoKToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgaWYgJzonIGluIGxpbmUgYW5kIG5vdCBsaW5lLnN0YXJ0c3dpdGgoJy9kZXYvJyk6CiAgICAgICAgICAgICAgICAgICAgIyDov5nmmK/orr7lpIflkI3np7AKICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2RldiA9IGxpbmUuc3BsaXQoJzonKVswXS5zdHJpcCgpCiAgICAgICAgICAgICAgICBlbGlmIGxpbmUuc3RhcnRzd2l0aCgnL2Rldi92aWRlbycpOgogICAgICAgICAgICAgICAgICAgICMg6L+Z5piv6KeG6aKR6K6+5aSH6Lev5b6ECiAgICAgICAgICAgICAgICAgICAgZGV2X3BhdGggPSBsaW5lLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhkZXZfcGF0aCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZXMuYXBwZW5kKGRldl9wYXRoKQogICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VfbmFtZXNbZGV2X3BhdGhdID0gY3VycmVudF9kZXYKICAgICAgICAgICAgCiAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiLmo4DmtYvliLDmiYDmnInop4bpopHorr7lpIc6IHtkZXZpY2VzfSIpCiAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiLorr7lpIflkI3np7DmmKDlsIQ6IHtkZXZpY2VfbmFtZXN9IikKICAgICAgICAgICAgCiAgICAgICAgICAgICMg5aaC5p6c5pyJ6YWN572u55qEVVNC56uv5Y+j77yM6L+b6KGM6L+H5rukCiAgICAgICAgICAgIGlmIHNlbGYudXNiX3BvcnQgYW5kIHNlbGYudXNiX3BvcnQgIT0gIiI6CiAgICAgICAgICAgICAgICByb3NweS5sb2dpbmZvKGYi5L2/55So6YWN572u55qEVVNC56uv5Y+j6L+H5ruk6KeG6aKR6K6+5aSHOiB7c2VsZi51c2JfcG9ydH0iKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIOaPkOWPllVTQue8luWPtwogICAgICAgICAgICAgICAgdXNiX251bWJlciA9IE5vbmUKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpZiAndHR5VVNCJyBpbiBzZWxmLnVzYl9wb3J0OgogICAgICAgICAgICAgICAgICAgICAgICB1c2JfbnVtYmVyID0gaW50KHNlbGYudXNiX3BvcnQucmVwbGFjZSgnL2Rldi90dHlVU0InLCAnJykpCiAgICAgICAgICAgICAgICAgICAgZWxpZiAndHR5QUNNJyBpbiBzZWxmLnVzYl9wb3J0OgogICAgICAgICAgICAgICAgICAgICAgICB1c2JfbnVtYmVyID0gaW50KHNlbGYudXNiX3BvcnQucmVwbGFjZSgnL2Rldi90dHlBQ00nLCAnJykpCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmaWx0ZXJlZF9kZXZpY2VzID0gW10KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9yIGRldiBpbiBkZXZpY2VzOgogICAgICAgICAgICAgICAgICAgICMg5pa55rOVMTog5bCd6K+V6YCa6L+H6K6+5aSH5ZCN56ew5Yy56YWNCiAgICAgICAgICAgICAgICAgICAgZGV2aWNlX25hbWUgPSBkZXZpY2VfbmFtZXMuZ2V0KGRldiwgJycpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIyDmo4Dmn6Xorr7lpIflkI3np7DkuK3mmK/lkKbljIXlkKtVU0Lnq6/lj6Pkv6Hmga8KICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLnVzYl9wb3J0IGluIGRldmljZV9uYW1lIG9yIGRldmljZV9uYW1lIGluIHNlbGYudXNiX3BvcnQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkX2RldmljZXMuYXBwZW5kKGRldikKICAgICAgICAgICAgICAgICAgICAgICAgcm9zcHkubG9naW5mbyhmIumAmui/h+WQjeensOWMuemFjeWIsOinhumikeiuvuWkhzoge2Rldn0gKOWQjeensDoge2RldmljZV9uYW1lfSkiKQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMg5pa55rOVMjog5bCd6K+V6YCa6L+H57yW5Y+35Yy56YWNCiAgICAgICAgICAgICAgICAgICAgaWYgdXNiX251bWJlciBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW9fbnVtYmVyID0gaW50KGRldi5yZXBsYWNlKCcvZGV2L3ZpZGVvJywgJycpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBVU0Lorr7lpIfpgJrluLjlr7nlupTnm7jlkIznvJblj7fnmoTop4bpopHorr7lpIcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHZpZGVvX251bWJlciA9PSB1c2JfbnVtYmVyIG9yIHZpZGVvX251bWJlciA9PSB1c2JfbnVtYmVyICsgMSBvciB2aWRlb19udW1iZXIgPT0gdXNiX251bWJlciAtIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRfZGV2aWNlcy5hcHBlbmQoZGV2KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiLpgJrov4fnvJblj7fljLnphY3liLDop4bpopHorr7lpIc6IHtkZXZ9IChVU0LnvJblj7c6IHt1c2JfbnVtYmVyfSwg6KeG6aKR57yW5Y+3OiB7dmlkZW9fbnVtYmVyfSkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAjIOaWueazlTM6IOWmguaenOS4iumdoumDveS4jeWMuemFje+8jOajgOafpeaYr+WQpuWcqOWQjOS4gOS4qlVTQuaAu+e6v+S4igogICAgICAgICAgICAgICAgICAgICMg6I635Y+W6KeG6aKR6K6+5aSH55qEVVNC5L+h5oGvCiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICB1ZGV2X2NtZCA9IFsndWRldmFkbScsICdpbmZvJywgJy1xJywgJ3BhdGgnLCAnLW4nLCBkZXZdCiAgICAgICAgICAgICAgICAgICAgICAgIHVkZXZfcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4odWRldl9jbWQsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgdWRldl9wYXRoID0gdWRldl9yZXN1bHQuc3Rkb3V0LnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHVkZXZfcGF0aCBhbmQgJ3VzYicgaW4gdWRldl9wYXRoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDmj5Dlj5ZVU0LmgLvnur/kv6Hmga8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYl9pbmZvID0gdWRldl9wYXRoLnNwbGl0KCcvJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBwYXJ0IGluIHVzYl9pbmZvOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICd1c2InIGluIHBhcnQgYW5kIGxlbihwYXJ0KSA+IDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg5q+U6L6DVVNC5oC757q/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYl9jbWQgPSBbJ3VkZXZhZG0nLCAnaW5mbycsICctcScsICdwYXRoJywgJy1uJywgc2VsZi51c2JfcG9ydF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNiX3Jlc3VsdCA9IHN1YnByb2Nlc3MucnVuKHVzYl9jbWQsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNiX3BhdGggPSB1c2JfcmVzdWx0LnN0ZG91dC5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwYXJ0IGluIHVzYl9wYXRoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRfZGV2aWNlcy5hcHBlbmQoZGV2KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9zcHkubG9naW5mbyhmIumAmui/h1VTQuaAu+e6v+WMuemFjeWIsOinhumikeiuvuWkhzoge2Rldn0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgZmlsdGVyZWRfZGV2aWNlczoKICAgICAgICAgICAgICAgICAgICBkZXZpY2VzID0gZmlsdGVyZWRfZGV2aWNlcwogICAgICAgICAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiLov4fmu6TlkI7nmoTop4bpopHorr7lpIc6IHtkZXZpY2VzfSIpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiLmnKrmib7liLDkuI4ge3NlbGYudXNiX3BvcnR9IOebuOWFs+eahOinhumikeiuvuWkh++8jOS9v+eUqOWJjSB7c2VsZi5tYXhfY2FtZXJhc30g5Liq6K6+5aSHIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiLmnKrmjIflrppVU0Lnq6/lj6PvvIzkvb/nlKjliY0ge3NlbGYubWF4X2NhbWVyYXN9IOS4quiuvuWkhyIpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIOmZkOWItuiuvuWkh+aVsOmHjwogICAgICAgICAgICBpZiBsZW4oZGV2aWNlcykgPiBzZWxmLm1heF9jYW1lcmFzOgogICAgICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXNbOnNlbGYubWF4X2NhbWVyYXNdCiAgICAgICAgICAgICAgICByb3NweS5sb2dpbmZvKGYi6ZmQ5Yi26K6+5aSH5pWw6YeP5Li6OiB7ZGV2aWNlc30iKQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHNvcnRlZChsaXN0KHNldChkZXZpY2VzKSkpIGlmIGRldmljZXMgZWxzZSBzb3J0ZWQoZ2xvYi5nbG9iKCcvZGV2L3ZpZGVvKicpKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcm9zcHkubG9nZXJyKGYi6I635Y+W6KeG6aKR6K6+5aSH5pe25Ye66ZSZOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gc29ydGVkKGdsb2IuZ2xvYignL2Rldi92aWRlbyonKSkKCiAgICBkZWYgX3RyeV9yZXNldF9kZXZpY2Uoc2VsZiwgZGV2X3BhdGgpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdWRldl9pbmZvID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICBbJ3VkZXZhZG0nLCAnaW5mbycsICctcScsICdwYXRoJywgJy1uJywgZGV2X3BhdGhdLAogICAgICAgICAgICAgICAgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlCiAgICAgICAgICAgICkuc3Rkb3V0LnN0cmlwKCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHVkZXZfaW5mbzoKICAgICAgICAgICAgICAgIHVzYl9wYXRoID0gZiIvc3lze3VkZXZfaW5mb30vLi4vcmVzZXQiCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyh1c2JfcGF0aCk6CiAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuKHVzYl9wYXRoLCAndycpIGFzIGY6CiAgICAgICAgICAgICAgICAgICAgICAgIGYud3JpdGUoJzEnKQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfaW5pdF9jYW1lcmEoc2VsZiwgZGV2X3BhdGgsIGNhbV9pZCk6CiAgICAgICAgZm9yIGF0dGVtcHQgaW4gcmFuZ2UoMyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhkZXZfcGF0aCk6CiAgICAgICAgICAgICAgICAgICAgcm9zcHkubG9nd2FybihmIuiuvuWkhyB7ZGV2X3BhdGh9IOS4jeWtmOWcqCIpCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICAgICBpZiBhdHRlbXB0ID4gMDoKICAgICAgICAgICAgICAgICAgICBzZWxmLl90cnlfcmVzZXRfZGV2aWNlKGRldl9wYXRoKQogICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbShmJ3N1ZG8gY2htb2QgNjY2IHtkZXZfcGF0aH0nKQogICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbShmJ3N1ZG8gZnVzZXIgLWsge2Rldl9wYXRofSAyPi9kZXYvbnVsbCcpCgogICAgICAgICAgICAgICAgIyDkvb/nlKjllK/kuIDnmoTnm7jmnLpJRO+8jOmBv+WFjeWGsueqgQogICAgICAgICAgICAgICAgdW5pcXVlX2NhbV9pZCA9IGYie3NlbGYubm9kZV9uYW1lfV9jYW17Y2FtX2lkfSIKICAgICAgICAgICAgICAgIGNhcCA9IGN2Mi5WaWRlb0NhcHR1cmUoZGV2X3BhdGgsIGN2Mi5DQVBfVjRMMikKICAgICAgICAgICAgICAgIGlmIG5vdCBjYXAuaXNPcGVuZWQoKToKICAgICAgICAgICAgICAgICAgICByb3NweS5sb2d3YXJuKCdPcGVuQ1bml6Dms5XmiZPlvIDorr7lpIcnKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICAgICAgICAgIGNhcC5zZXQoY3YyLkNBUF9QUk9QX0ZPVVJDQywgY3YyLlZpZGVvV3JpdGVyX2ZvdXJjYygnTScsJ0onLCdQJywnRycpKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIOWwneivleiuvue9ruaMh+WumueahOWIhui+qOeOhwogICAgICAgICAgICAgICAgc3VjY2VzcyA9IEZhbHNlCiAgICAgICAgICAgICAgICBhY3R1YWxfd2lkdGggPSAwCiAgICAgICAgICAgICAgICBhY3R1YWxfaGVpZ2h0ID0gMAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb3IgcmVzIGluIHNlbGYucmVzb2x1dGlvbnM6CiAgICAgICAgICAgICAgICAgICAgY2FwLnNldChjdjIuQ0FQX1BST1BfRlJBTUVfV0lEVEgsIHJlc1swXSkKICAgICAgICAgICAgICAgICAgICBjYXAuc2V0KGN2Mi5DQVBfUFJPUF9GUkFNRV9IRUlHSFQsIHJlc1sxXSkKICAgICAgICAgICAgICAgICAgICBhY3R1YWxfd2lkdGggPSBpbnQoY2FwLmdldChjdjIuQ0FQX1BST1BfRlJBTUVfV0lEVEgpKQogICAgICAgICAgICAgICAgICAgIGFjdHVhbF9oZWlnaHQgPSBpbnQoY2FwLmdldChjdjIuQ0FQX1BST1BfRlJBTUVfSEVJR0hUKSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBhY3R1YWxfd2lkdGggPT0gcmVzWzBdIGFuZCBhY3R1YWxfaGVpZ2h0ID09IHJlc1sxXToKICAgICAgICAgICAgICAgICAgICAgICAgcm9zcHkubG9naW5mbyhmIuaRhOWDj+WktHt1bmlxdWVfY2FtX2lkfeaIkOWKn+iuvue9ruS4uiB7YWN0dWFsX3dpZHRofXh7YWN0dWFsX2hlaWdodH0iKQogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHJvc3B5LmxvZ3dhcm4oZiLmkYTlg4/lpLR7dW5pcXVlX2NhbV9pZH3ml6Dms5Xorr7nva7kuLoge3Jlc1swXX14e3Jlc1sxXX0sIOWunumZheS4uiB7YWN0dWFsX3dpZHRofXh7YWN0dWFsX2hlaWdodH0iKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBub3Qgc3VjY2VzczoKICAgICAgICAgICAgICAgICAgICByb3NweS5sb2d3YXJuKGYi5pGE5YOP5aS0e3VuaXF1ZV9jYW1faWR95peg5rOV6K6+572u5Li65Lu75L2V5oyH5a6a5YiG6L6o546H77yM5L2/55So6buY6K6k5YiG6L6o546HIHthY3R1YWxfd2lkdGh9eHthY3R1YWxfaGVpZ2h0fSIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZvciBfIGluIHJhbmdlKDUpOgogICAgICAgICAgICAgICAgICAgIGNhcC5ncmFiKCkKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDAuMDEpCgogICAgICAgICAgICAgICAgIyDlho3mrKHojrflj5blrp7pmYXliIbovqjnjocKICAgICAgICAgICAgICAgIGFjdHVhbF93aWR0aCA9IGludChjYXAuZ2V0KGN2Mi5DQVBfUFJPUF9GUkFNRV9XSURUSCkpCiAgICAgICAgICAgICAgICBhY3R1YWxfaGVpZ2h0ID0gaW50KGNhcC5nZXQoY3YyLkNBUF9QUk9QX0ZSQU1FX0hFSUdIVCkpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMg5L2/55So5ZSv5LiA55qE56qX5Y+j5ZCNCiAgICAgICAgICAgICAgICB3aW5kb3dfbmFtZSA9IGYne3NlbGYubm9kZV9uYW1lfV97Y2FtX2lkfV97YWN0dWFsX3dpZHRofXh7YWN0dWFsX2hlaWdodH0nCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHNlbGYuY2FtZXJhcy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICdpZCc6IGNhbV9pZCwKICAgICAgICAgICAgICAgICAgICAndW5pcXVlX2lkJzogdW5pcXVlX2NhbV9pZCwKICAgICAgICAgICAgICAgICAgICAnY2FwJzogY2FwLAogICAgICAgICAgICAgICAgICAgICdkZXYnOiBkZXZfcGF0aCwKICAgICAgICAgICAgICAgICAgICAnZnJhbWVfY291bnQnOiAwLAogICAgICAgICAgICAgICAgICAgICd3aWR0aCc6IGFjdHVhbF93aWR0aCwKICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JzogYWN0dWFsX2hlaWdodCwKICAgICAgICAgICAgICAgICAgICAnd2luZG93X25hbWUnOiB3aW5kb3dfbmFtZQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICByb3NweS5sb2dlcnIoZiLlsJ3or5Uje2F0dGVtcHQrMX0g5Yid5aeL5YyWIHtkZXZfcGF0aH0g5aSx6LSlOiB7c3RyKGUpfSIpCiAgICAgICAgICAgICAgICBpZiAnY2FwJyBpbiBsb2NhbHMoKSBhbmQgY2FwLmlzT3BlbmVkKCk6CiAgICAgICAgICAgICAgICAgICAgY2FwLnJlbGVhc2UoKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfaW5pdF9jYW1lcmFzKHNlbGYpOgogICAgICAgIGRldmljZXMgPSBzZWxmLl9nZXRfcGh5c2ljYWxfZGV2aWNlcygpCiAgICAgICAgcm9zcHkubG9naW5mbyhmIuWwhuWIneWni+WMlueahOinhumikeiuvuWkhzoge2RldmljZXN9IikKICAgICAgICBzZWxmLl9pbml0X21haW5fb3Jfc2Vjb25kX2NhbWVyYShzZWxmLnZpZGVvMF9tYWluLCBzZWxmLnZpZGVvMF9zZWMsIDApCiAgICAgICAgc2VsZi5faW5pdF9tYWluX29yX3NlY29uZF9jYW1lcmEoc2VsZi52aWRlbzFfbWFpbiwgc2VsZi52aWRlbzFfc2VjLCAxKQogICAgICAgIHNlbGYuX2luaXRfbWFpbl9vcl9zZWNvbmRfY2FtZXJhKHNlbGYudmlkZW8yX21haW4sIHNlbGYudmlkZW8yX3NlYywgMikKCgogICAgICAgIGlmIG5vdCBzZWxmLmNhbWVyYXM6CiAgICAgICAgICAgIHJvc3B5LmxvZ2VycigiXG7inYwg6ZSZ6K+v77ya5rKh5pyJ5Y+v55So55qE5pGE5YOP5aS0IikKICAgICAgICAgICAgcm9zcHkubG9naW5mbygi6K+35omn6KGM5Lul5LiL6K+K5pat5ZG95Luk77yaIikKICAgICAgICAgICAgcm9zcHkubG9naW5mbygiMS4g5qOA5p+l6K6+5aSH6L+e5o6lOiBscyAvZGV2L3ZpZGVvKiIpCiAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oIjIuIOafpeeci+iuvuWkh+S/oeaBrzogdjRsMi1jdGwgLS1saXN0LWRldmljZXMiKQogICAgICAgICAgICByb3NweS5sb2dpbmZvKCIzLiDkv67lpI3mnYPpmZA6IHN1ZG8gY2htb2QgNjY2IC9kZXYvdmlkZW8qIikKICAgICAgICAgICAgcm9zcHkubG9naW5mbygiNC4g6YeN572uVVNC6K6+5aSHOiBzdWRvIHVzYi1yZXNldCIpCiAgICAgICAgICAgIGV4aXQoMSkKCiAgICBkZWYgX2luaXRfbWFpbl9vcl9zZWNvbmRfY2FtZXJhKHNlbGYsIGRldl9tYWluLCBkZXZfc2Vjb25kLCBpbmRleCk6CiAgICAgICAgaWYgc2VsZi5faW5pdF9jYW1lcmEoZGV2X21haW4sIGluZGV4KToKICAgICAgICAgICAgcm9zcHkubG9naW5mbyhmIuaIkOWKn+WIneWni+WMluaRhOWDj+WktCB7ZGV2X21haW59IOS4uiB7c2VsZi5jYW1lcmFzWy0xXVsndW5pcXVlX2lkJ119IikKICAgICAgICBlbHNlOgogICAgICAgICAgICByb3NweS5sb2d3YXJuKGYi4pqg77iPIOaXoOazleWIneWni+WMluiuvuWkhyB7ZGV2X21haW5977yM5bey6Lez6L+HIikKCiAgICAgICAgaWYgc2VsZi5faW5pdF9jYW1lcmEoZGV2X3NlY29uZCwgaW5kZXgpOgogICAgICAgICAgICByb3NweS5sb2dpbmZvKGYi5oiQ5Yqf5Yid5aeL5YyW5pGE5YOP5aS0IHtkZXZfc2Vjb25kfSDkuLoge3NlbGYuY2FtZXJhc1stMV1bJ3VuaXF1ZV9pZCddfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcm9zcHkubG9nd2FybihmIuKaoO+4jyDml6Dms5XliJ3lp4vljJborr7lpIcge2Rldl9zZWNvbmR977yM5bey6Lez6L+HIikKCiAgICBkZWYgX2luaXRfcm9zX3B1Ymxpc2hlcnMoc2VsZik6CiAgICAgICAgIiIi5Yid5aeL5YyWUk9T5Y+R5biD5ZmoIiIiCiAgICAgICAgZm9yIGNhbSBpbiBzZWxmLmNhbWVyYXM6CiAgICAgICAgICAgICMg5Li65q+P5Liq5pGE5YOP5aS05Yib5bu65a+55bqU55qEdG9waWMKICAgICAgICAgICAgaWYgc2VsZi50b3BpY19iYXNlOgogICAgICAgICAgICAgICAgaWYgY2FtWydpZCddID09IDA6CiAgICAgICAgICAgICAgICAgICAgdG9waWNfbmFtZSA9IGYne3NlbGYudG9waWNfYmFzZX0vY29sb3IvaW1hZ2VfcmF3JwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0b3BpY19uYW1lID0gZid7c2VsZi50b3BpY19iYXNlfV97Y2FtWyJpZCJdfS9jb2xvci9pbWFnZV9yYXcnCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIOWQkeWQjuWFvOWuuQogICAgICAgICAgICAgICAgaWYgY2FtWydpZCddID09IDA6CiAgICAgICAgICAgICAgICAgICAgdG9waWNfbmFtZSA9ICcvY2FtZXJhX2Zpc2hleWUvY29sb3IvaW1hZ2VfcmF3JwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0b3BpY19uYW1lID0gZicvY2FtZXJhX2Zpc2hleWUvY29sb3IvaW1hZ2VfcmF3X3tjYW1bImlkIl0gKyAxfScKICAgICAgICAgICAgCiAgICAgICAgICAgIHB1Ymxpc2hlciA9IHJvc3B5LlB1Ymxpc2hlcih0b3BpY19uYW1lLCBJbWFnZSwgcXVldWVfc2l6ZT0xMCkKICAgICAgICAgICAgc2VsZi5pbWFnZV9wdWJsaXNoZXJzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAncHVibGlzaGVyJzogcHVibGlzaGVyLAogICAgICAgICAgICAgICAgJ2NhbV9pZCc6IGNhbVsnaWQnXSwKICAgICAgICAgICAgICAgICd1bmlxdWVfaWQnOiBjYW1bJ3VuaXF1ZV9pZCddLAogICAgICAgICAgICAgICAgJ3RvcGljX25hbWUnOiB0b3BpY19uYW1lCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiLmkYTlg4/lpLR7Y2FtWyd1bmlxdWVfaWQnXX3lj5HluIPliLB0b3BpYzoge3RvcGljX25hbWV9IikKCiAgICBkZWYgX3B1Ymxpc2hfZnJhbWUoc2VsZiwgY2FtX2lkLCBmcmFtZSwgdGltZXN0YW1wX25zKToKICAgICAgICAiIiLlj5HluIPlm77lg4/luKfliLBST1MgdG9waWMiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgICMg5qOA5p+lIGZyYW1lIOaYr+WQpuacieaViAogICAgICAgICAgICBpZiBmcmFtZSBpcyBOb25lIG9yIGZyYW1lLnNpemUgPT0gMDoKICAgICAgICAgICAgICAgIHJvc3B5LmxvZ3dhcm4oZiLmkYTlg4/lpLR7Y2FtX2lkfeWbvuWDj+S4uuepuiIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgICAgICMg5qOA5p+l5Zu+5YOP5b2i54q2CiAgICAgICAgICAgIGlmIGxlbihmcmFtZS5zaGFwZSkgIT0gMyBvciBmcmFtZS5zaGFwZVsyXSAhPSAzOgogICAgICAgICAgICAgICAgcm9zcHkubG9nd2FybihmIuaRhOWDj+WktHtjYW1faWR95Zu+5YOP5b2i54q25LiN5q2j56GuOiB7ZnJhbWUuc2hhcGV9IikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICMg5omL5Yqo5Yib5bu6IFJPUyBJbWFnZSDmtojmga8KICAgICAgICAgICAgcm9zX2ltYWdlID0gSW1hZ2UoKQogICAgICAgICAgICAKICAgICAgICAgICAgIyDorr7nva7ml7bpl7TmiLMKICAgICAgICAgICAgcm9zX2ltYWdlLmhlYWRlci5zdGFtcCA9IHJvc3B5LlRpbWUuZnJvbV9zZWModGltZXN0YW1wX25zIC8gMWU5KQogICAgICAgICAgICAKICAgICAgICAgICAgIyDorr7nva4gZnJhbWVfaWQKICAgICAgICAgICAgZm9yIGNhbSBpbiBzZWxmLmNhbWVyYXM6CiAgICAgICAgICAgICAgICBpZiBjYW1bJ2lkJ10gPT0gY2FtX2lkOgogICAgICAgICAgICAgICAgICAgIHJvc19pbWFnZS5oZWFkZXIuZnJhbWVfaWQgPSBjYW1bJ3VuaXF1ZV9pZCddCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgCiAgICAgICAgICAgICMg6K6+572u5Zu+5YOP5Y+C5pWwCiAgICAgICAgICAgIGhlaWdodCwgd2lkdGggPSBmcmFtZS5zaGFwZVs6Ml0KICAgICAgICAgICAgcm9zX2ltYWdlLmhlaWdodCA9IGhlaWdodAogICAgICAgICAgICByb3NfaW1hZ2Uud2lkdGggPSB3aWR0aAogICAgICAgICAgICAKICAgICAgICAgICAgIyDkvb/nlKggQkdSOCDnvJbnoIHvvIhPcGVuQ1bpu5jorqTmoLzlvI/vvIkKICAgICAgICAgICAgcm9zX2ltYWdlLmVuY29kaW5nID0gJ2JncjgnCiAgICAgICAgICAgIHJvc19pbWFnZS5zdGVwID0gd2lkdGggKiAzCiAgICAgICAgICAgIHJvc19pbWFnZS5pc19iaWdlbmRpYW4gPSAwCiAgICAgICAgICAgIAogICAgICAgICAgICAjIOehruS/neaVsOaNruaYr+i/nue7reeahOWGheWtmOWdlwogICAgICAgICAgICBpZiBub3QgZnJhbWUuZmxhZ3NbJ0NfQ09OVElHVU9VUyddOgogICAgICAgICAgICAgICAgZnJhbWUgPSBucC5hc2NvbnRpZ3VvdXNhcnJheShmcmFtZSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMg6K6+572u5Zu+5YOP5pWw5o2uCiAgICAgICAgICAgIHJvc19pbWFnZS5kYXRhID0gZnJhbWUudG9ieXRlcygpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIOWPkeW4g+a2iOaBrwogICAgICAgICAgICBmb3IgcHViX2luZm8gaW4gc2VsZi5pbWFnZV9wdWJsaXNoZXJzOgogICAgICAgICAgICAgICAgaWYgcHViX2luZm9bJ2NhbV9pZCddID09IGNhbV9pZDoKICAgICAgICAgICAgICAgICAgICBwdWJfaW5mb1sncHVibGlzaGVyJ10ucHVibGlzaChyb3NfaW1hZ2UpCiAgICAgICAgICAgICAgICAgICAgcm9zcHkubG9nZGVidWdfb25jZShmIuaIkOWKn+WPkeW4g+aRhOWDj+WktHtjYW1faWR95Zu+5YOPOiB7d2lkdGh9eHtoZWlnaHR9IikKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcm9zcHkubG9nZXJyKGYi5Y+R5biD5pGE5YOP5aS0e2NhbV9pZH3lm77lg4/lpLHotKU6IHtzdHIoZSl9IikKCiAgICBkZWYgX2Rpc3BsYXlfZnJhbWVzKHNlbGYsIGZyYW1lc19kYXRhKToKICAgICAgICAiIiLmmL7npLrmkYTlg4/lpLTnlLvpnaIiIiIKICAgICAgICBmb3IgY2FtLCBmcmFtZSBpbiBmcmFtZXNfZGF0YToKICAgICAgICAgICAgaWYgZnJhbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAjIOWcqOeUu+mdouS4iua3u+WKoOaXtumXtOaIs+WSjOW4p+iuoeaVsOS/oeaBrwogICAgICAgICAgICAgICAgdGltZXN0YW1wID0gdGltZS5zdHJmdGltZSgiJVktJW0tJWQgJUg6JU06JVMiLCB0aW1lLmxvY2FsdGltZSgpKQogICAgICAgICAgICAgICAgaW5mb190ZXh0ID0gZiJ7Y2FtWyd1bmlxdWVfaWQnXX0gfCB7dGltZXN0YW1wfSB8IEZyYW1lczoge2NhbVsnZnJhbWVfY291bnQnXX0iCiAgICAgICAgICAgICAgICBjdjIucHV0VGV4dChmcmFtZSwgaW5mb190ZXh0LCAoMTAsIDMwKSwgY3YyLkZPTlRfSEVSU0hFWV9TSU1QTEVYLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAwLjcsICgwLCAyNTUsIDApLCAyKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIOaYvuekuueUu+mdogogICAgICAgICAgICAgICAgY3YyLmltc2hvdyhjYW1bJ3dpbmRvd19uYW1lJ10sIGZyYW1lKQogICAgICAgIAogICAgICAgICMg5qOA5p+l5piv5ZCm5oyJ5LiLRVND6ZSuCiAgICAgICAgaWYgY3YyLndhaXRLZXkoMSkgPT0gMjc6CiAgICAgICAgICAgIHNlbGYucnVubmluZyA9IEZhbHNlCgogICAgZGVmIGNhcHR1cmVfZnJhbWVzKHNlbGYpOgogICAgICAgIHJvc3B5LmxvZ2luZm8oZiJcbuW8gOWni+aMgee7remHh+mbhiB7bGVuKHNlbGYuY2FtZXJhcyl9IOS4quaRhOWDj+WktC4uLiIpCiAgICAgICAgcm9zcHkubG9naW5mbygi5oyJ5LiLRVND6ZSu5oiWQ3RybCtD5YGc5q2i6YeH6ZuGIikKICAgICAgICAKICAgICAgICAjIOWIm+W7uumihOiniOeql+WPowogICAgICAgIGlmIHNlbGYuc2hvd19wcmV2aWV3OgogICAgICAgICAgICBmb3IgY2FtIGluIHNlbGYuY2FtZXJhczoKICAgICAgICAgICAgICAgIFJFU0laRV9XSURUSCA9IDY0MAogICAgICAgICAgICAgICAgUkVTSVpFX0hFSUdIVCA9IDQ4MAogICAgICAgICAgICAgICAgIyDkvb/nlKjllK/kuIDnmoTnqpflj6PlkI0KICAgICAgICAgICAgICAgIGN2Mi5uYW1lZFdpbmRvdyhjYW1bJ3dpbmRvd19uYW1lJ10sIGN2Mi5XSU5ET1dfTk9STUFMKQogICAgICAgICAgICAgICAgY3YyLnJlc2l6ZVdpbmRvdyhjYW1bJ3dpbmRvd19uYW1lJ10sIFJFU0laRV9XSURUSCwgUkVTSVpFX0hFSUdIVCkKICAgICAgICAKICAgICAgICBmcmFtZV9udW0gPSAwCiAgICAgICAgcmF0ZSA9IHJvc3B5LlJhdGUoMzApICAjIDMwSHoKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIHNlbGYucnVubmluZyBhbmQgbm90IHJvc3B5LmlzX3NodXRkb3duKCk6CiAgICAgICAgICAgICAgICBmcmFtZXNfZGF0YSA9IFtdCiAgICAgICAgICAgICAgICB0aW1lc3RhbXBfbnMgPSB0aW1lLnRpbWVfbnMoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIOivu+WPluaJgOacieaRhOWDj+WktOeahOW4pwogICAgICAgICAgICAgICAgZm9yIGNhbSBpbiBzZWxmLmNhbWVyYXM6CiAgICAgICAgICAgICAgICAgICAgcmV0LCBmcmFtZSA9IGNhbVsnY2FwJ10ucmVhZCgpCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHJldDoKICAgICAgICAgICAgICAgICAgICAgICAgIyByb3NweS5sb2d3YXJuKGYi5pGE5YOP5aS0IHtjYW1bJ3VuaXF1ZV9pZCddfSDnrKx7ZnJhbWVfbnVtfeW4p+mHh+mbhuWksei0pSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lID0gTm9uZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICMg5Y+R5biD5YiwUk9TCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3B1Ymxpc2hfZnJhbWUoY2FtWydpZCddLCBmcmFtZSwgdGltZXN0YW1wX25zKQogICAgICAgICAgICAgICAgICAgICAgICBjYW1bJ2ZyYW1lX2NvdW50J10gKz0gMQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGZyYW1lc19kYXRhLmFwcGVuZCgoY2FtLCBmcmFtZSkpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMg5pi+56S65a6e5pe26aKE6KeICiAgICAgICAgICAgICAgICBpZiBzZWxmLnNob3dfcHJldmlldzoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9kaXNwbGF5X2ZyYW1lcyhmcmFtZXNfZGF0YSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyDmiZPljbDnirbmgIHkv6Hmga8KICAgICAgICAgICAgICAgIGlmIGZyYW1lX251bSAlIDMwID09IDA6CiAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gIiB8ICIuam9pbihbZiJ7Y2FtWyd1bmlxdWVfaWQnXX06e2NhbVsnZnJhbWVfY291bnQnXX3luKciIGZvciBjYW0gaW4gc2VsZi5jYW1lcmFzXSkKICAgICAgICAgICAgICAgICAgICByb3NweS5sb2dpbmZvKGYi5bey5Y+R5biDOiB7ZnJhbWVfbnVtKzF95binIHwg5pGE5YOP5aS054q25oCBOiB7c3RhdHVzfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZyYW1lX251bSArPSAxCiAgICAgICAgICAgICAgICByYXRlLnNsZWVwKCkKICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcm9zcHkubG9nZXJyKGYi6YeH6ZuG6L+H56iL5Lit5Ye66ZSZOiB7ZX0iKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHNlbGYuX3JlbGVhc2VfcmVzb3VyY2VzKCkKICAgICAgICAgICAgIyBzZWxmLl9nZW5lcmF0ZV9yZXBvcnQoKQoKICAgIGRlZiBfcmVsZWFzZV9yZXNvdXJjZXMoc2VsZik6CiAgICAgICAgIiIi6YeK5pS+6LWE5rqQIiIiCiAgICAgICAgZm9yIGNhbSBpbiBzZWxmLmNhbWVyYXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGNhbVsnY2FwJ10ucmVsZWFzZSgpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAKICAgICAgICAjIOWFs+mXreaJgOacieWxnuS6juacrOiKgueCueeahOeql+WPowogICAgICAgIGlmIHNlbGYuc2hvd19wcmV2aWV3OgogICAgICAgICAgICBmb3IgY2FtIGluIHNlbGYuY2FtZXJhczoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBjdjIuZGVzdHJveVdpbmRvdyhjYW1bJ3dpbmRvd19uYW1lJ10pCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2VuZXJhdGVfcmVwb3J0KHNlbGYpOgogICAgICAgICIiIueUn+aIkOmHh+mbhuaKpeWRiiIiIgogICAgICAgIHJvc3B5LmxvZ2luZm8oIlxuPT09IOmHh+mbhuaKpeWRiiA9PT0iKQogICAgICAgIGZvciBjYW0gaW4gc2VsZi5jYW1lcmFzOgogICAgICAgICAgICByb3NweS5sb2dpbmZvKGYi5pGE5YOP5aS0e2NhbVsndW5pcXVlX2lkJ119W3tjYW1bJ2RldiddfV0iKQogICAgICAgICAgICByb3NweS5sb2dpbmZvKGYiICDliIbovqjnjoc6IHtjYW1bJ3dpZHRoJ119eHtjYW1bJ2hlaWdodCddfSIpCiAgICAgICAgICAgIHJvc3B5LmxvZ2luZm8oZiIgIOaIkOWKn+WPkeW4gzoge2NhbVsnZnJhbWVfY291bnQnXX3luKciKQogICAgICAgICAgICBmb3IgcHViX2luZm8gaW4gc2VsZi5pbWFnZV9wdWJsaXNoZXJzOgogICAgICAgICAgICAgICAgaWYgcHViX2luZm9bJ2NhbV9pZCddID09IGNhbVsnaWQnXToKICAgICAgICAgICAgICAgICAgICByb3NweS5sb2dpbmZvKGYiICBST1MgVG9waWM6IHtwdWJfaW5mb1sndG9waWNfbmFtZSddfSIpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICB0cnk6CiAgICAgICAgb3MubmljZSgtMjApCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwoKICAgIGN2Mi5zZXROdW1UaHJlYWRzKDEpCiAgICBjdjIuc2V0VXNlT3B0aW1pemVkKFRydWUpCgogICAgIyDov4fmu6RST1Poh6rliqjmt7vliqDnmoTlj4LmlbAKICAgIGltcG9ydCBhcmdwYXJzZQogICAgCiAgICByb3NfYXJncyA9IFsnX19uYW1lOj0nLCAnX19sb2c6PScsICdfX21hc3Rlcjo9JywgJ19faXA6PSddCiAgICBmaWx0ZXJlZF9hcmdzID0gW10KICAgIAogICAgZm9yIGFyZyBpbiBzeXMuYXJndlsxOl06CiAgICAgICAgaWYgbm90IGFueShhcmcuc3RhcnRzd2l0aChyb3NfYXJnKSBmb3Igcm9zX2FyZyBpbiByb3NfYXJncyk6CiAgICAgICAgICAgIGZpbHRlcmVkX2FyZ3MuYXBwZW5kKGFyZykKICAgIAogICAgc3lzLmFyZ3YgPSBbc3lzLmFyZ3ZbMF1dICsgZmlsdGVyZWRfYXJncwogICAgCiAgICAjIOino+aekOWRveS7pOihjOWPguaVsO+8iOeUqOS6juiwg+ivle+8iQogICAgcGFyc2VyID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoZGVzY3JpcHRpb249IkNhbWVyYSBjYXB0dXJlIHNjcmlwdCB3aXRoIFJPUyIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW5vLXByZXZpZXciLCBkZXN0PSJzaG93X3ByZXZpZXciLCBhY3Rpb249InN0b3JlX2ZhbHNlIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJEaXNhYmxlIHByZXZpZXcgd2luZG93IikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tdXNiLXBvcnQiLCB0eXBlPXN0ciwgZGVmYXVsdD0iIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJVU0IgcG9ydCBmb3IgZmlsdGVyaW5nIHZpZGVvIGRldmljZXMiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS12aWRlb18wX21haW4iLCB0eXBlPXN0ciwgZGVmYXVsdD0iIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJjZW50ZXIgdmlkZW8gZGV2aWNlcyIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXZpZGVvXzFfbWFpbiIsIHR5cGU9c3RyLCBkZWZhdWx0PSIiLAogICAgICAgICAgICAgICAgICAgICAgIGhlbHA9InZpZGVvIGRldmljZXMiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS12aWRlb18yX21haW4iLCB0eXBlPXN0ciwgZGVmYXVsdD0iIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJ2aWRlbyBkZXZpY2VzIikKICAgIAogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS12aWRlb18wX3NlYyIsIHR5cGU9c3RyLCBkZWZhdWx0PSIiLAogICAgICAgICAgICAgICAgICAgICAgIGhlbHA9ImNlbnRlciB2aWRlbyBkZXZpY2VzIikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tdmlkZW9fMV9zZWMiLCB0eXBlPXN0ciwgZGVmYXVsdD0iIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJsZWZ0IHZpZGVvIGRldmljZXMiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS12aWRlb18yX3NlYyIsIHR5cGU9c3RyLCBkZWZhdWx0PSIiLAogICAgICAgICAgICAgICAgICAgICAgIGhlbHA9InZpZGVvIGRldmljZXMiKQogICAgcGFyc2VyLnNldF9kZWZhdWx0cyhzaG93X3ByZXZpZXc9VHJ1ZSkKICAgIGFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncygpCiAgICAKICAgIHRyeToKICAgICAgICAjIOeOsOWcqOS7jlJPU+WPguaVsOiOt+WPluaJgOaciemFjee9rgogICAgICAgIHJlY29yZGVyID0gQ2FtZXJhQ2FwdHVyZVJPUygpCiAgICAgICAgcmVjb3JkZXIuY2FwdHVyZV9mcmFtZXMoKQogICAgZXhjZXB0IHJvc3B5LlJPU0ludGVycnVwdEV4Y2VwdGlvbjoKICAgICAgICBwcmludCgiUk9T5Lit5patIikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIuKdjCDns7vnu5/ltKnmuoM6IHtzdHIoZSl9IikKICAgICAgICBwcmludCgiXG7wn5qRIOe0p+aApeaBouWkjeW7uuiurjoiKQogICAgICAgIHByaW50KCIxLiDniannkIbph43lkK/mkYTlg4/lpLTorr7lpIciKQogICAgICAgIHByaW50KCIyLiDmiafooYw6IHN1ZG8gcm1tb2QgdXZjdmlkZW8gJiYgc3VkbyBtb2Rwcm9iZSB1dmN2aWRlbyIpCiAgICAgICAgcHJpbnQoIjMuIOWwneivleWFtuS7llVTQuaOpeWPoyIp
'''

def decode_and_execute():
    """解码并执行源码"""
    try:
        # 解码源码
        source_code = base64.b64decode(ENCODED_SOURCE).decode('utf-8')
        
        # 编译并执行
        code = compile(source_code, 'camera_view_single.py', 'exec')
        
        # 创建模块
        module = types.ModuleType('camera_view_single')
        
        # 设置全局命名空间
        import builtins
        globals_dict = {
            '__name__': '__main__',
            '__file__': __file__,
            '__package__': None,
            '__builtins__': builtins,
        }
        
        # 执行编译后的代码
        exec(code, globals_dict)
        
        # 返回模块
        return module
    except Exception as e:
        print(f"解码错误: {e}")
        raise

def main():
    """主函数"""
    try:
        # 解码并获取模块
        module = decode_and_execute()
        
        # 调用原始main函数
        if hasattr(module, 'main'):
            sys.argv[0] = 'camera_view_single.py'
            module.main()
        else:
            # print("错误: 找不到main函数")
            sys.exit(1)
    except Exception as e:
        print(f"执行错误: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)

if __name__ == '__main__':
    main()

#!/usr/bin/env python3
# 混淆的pack模块
import sys
import os
import base64

_script_dir = os.path.dirname(os.path.abspath(__file__))
if _script_dir not in sys.path:
    sys.path.insert(0, _script_dir)

ENCODED_SOURCE = '''
aW1wb3J0IHN0cnVjdApmcm9tIGVudW0gaW1wb3J0IEVudW0KZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QKaW1wb3J0IHRyYWNlYmFjawppbXBvcnQgb3MKCmNsYXNzIFBhY2tUeXBlKEVudW0pOgogICAgUGFja1R5cGVDTUQgPSAiQ01EIgogICAgUGFja1R5cGVNZXNzYWdlID0gIk1lc3NhZ2UiCgoKY2xhc3MgUGFja0NvbnRlbnQ6CiAgICBNYWdpYyA9IGIiZGFzXHJcbiIKCgpjbGFzcyBPcGNvZGUoRW51bSk6CiAgICBSZWFkU2luZ2xlID0gMHgwMQogICAgUmVhZEJhdGNoID0gMHgwMgogICAgV3JpdGVEcml2ZSA9IDB4MDMKICAgIEVjaG8gPSAweDA0CiAgICBDYWxpYkVuY29kZXIgPSAweDA1CiAgICBEaXNhYmxlRHJpdmUgPSAweDA2CgoKY2xhc3MgUmVjb3JkVHlwZShFbnVtKToKICAgIFRhY3RpbGUgPSAweDAxCiAgICBFbmNvZGVyID0gMHgwMgogICAgRHJpdmUgPSAweDAzCiAgICBFY2hvID0gMHgwNAoKCmNsYXNzIFJlY29yZChvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHJlY29yZF90eXBlOiBSZWNvcmRUeXBlLCByZWNvcmRfZGF0YTogYnl0ZXMpOgogICAgICAgIHNlbGYucmVjb3JkX3R5cGUgPSByZWNvcmRfdHlwZQogICAgICAgIHNlbGYucmVjb3JkX2NvbnRlbnRfbGVuZ3RoID0gbGVuKHJlY29yZF9kYXRhKQogICAgICAgIHNlbGYucmVjb3JkX2RhdGEgPSByZWNvcmRfZGF0YQoKICAgIGRlZiBwYWNrKHNlbGYpIC0+IGJ5dGVzOgogICAgICAgIHBhY2tldCA9IGIiIgogICAgICAgIHBhY2tldCArPSBzdHJ1Y3QucGFjaygiQiIsIHNlbGYucmVjb3JkX3R5cGUudmFsdWUpCiAgICAgICAgcGFja2V0ICs9IHN0cnVjdC5wYWNrKAogICAgICAgICAgICAiPFEiLCBzZWxmLnJlY29yZF9jb250ZW50X2xlbmd0aAogICAgICAgICkgICMgPFEg6KGo56S65bCP56uv5peg56ym5Y+3NjTkvY3mlbTmlbAKICAgICAgICBwYWNrZXQgKz0gc2VsZi5yZWNvcmRfZGF0YQogICAgICAgIHJldHVybiBwYWNrZXQKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICJyZWNvcmRfdHlwZToge30sIHJlY29yZF9jb250ZW50X2xlbmd0aDoge30sIHJlY29yZF9kYXRhOiB7fVxuIi5mb3JtYXQoCiAgICAgICAgICAgIHNlbGYucmVjb3JkX3R5cGUsIHNlbGYucmVjb3JkX2NvbnRlbnRfbGVuZ3RoLCBzZWxmLnJlY29yZF9kYXRhCiAgICAgICAgKQoKCmNsYXNzIFBhY2sob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIHBhY2tfdHlwZTogUGFja1R5cGUgPSBQYWNrVHlwZS5QYWNrVHlwZUNNRCwKICAgICAgICBkYXRhOiBieXRlcyA9IGIiIiwKICAgICAgICBvcGNvZGU9Tm9uZSwKICAgICk6CiAgICAgICAgc2VsZi5kYXRhID0gZGF0YQogICAgICAgIHNlbGYucGFja190eXBlXyA9IHBhY2tfdHlwZQogICAgICAgIHNlbGYub3Bjb2RlXyA9IG9wY29kZQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHBhcnNlKGNscywgZGF0YTogYnl0ZXMsIHRhcmdldF90eXBlOiBQYWNrVHlwZSA9IFBhY2tUeXBlLlBhY2tUeXBlQ01EKSAtPiAiUGFjayI6CiAgICAgICAgaWYgbm90IGNscy5jaGVja19oZWFkKGRhdGEpIG9yIG5vdCBjbHMuY2hlY2tfdGFpbChkYXRhKToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBjaGVja19oZWFkKGNscywgZGF0YSkgLT4gYm9vbDoKICAgICAgICBpZiBub3QgY2xzLmNoZWNrX21hZ2ljKGRhdGFbMCA6IGxlbihQYWNrQ29udGVudC5NYWdpYyldKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIHJldHVybiBUcnVlCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgY2hlY2tfdGFpbChjbHMsIGRhdGEpIC0+IGJvb2w6CiAgICAgICAgaWYgbm90IGNscy5jaGVja19tYWdpYyhkYXRhWy1sZW4oUGFja0NvbnRlbnQuTWFnaWMpIDpdKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIHJldHVybiBUcnVlCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgY2hlY2tfbWFnaWMoY2xzLCBkYXRhKSAtPiBib29sOgogICAgICAgIGlmIGxlbihkYXRhKSA8IGxlbihQYWNrQ29udGVudC5NYWdpYyk6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICBpZiBkYXRhICE9IFBhY2tDb250ZW50Lk1hZ2ljOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gVHJ1ZQoKCmNsYXNzIENtZFBhY2soUGFjayk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBwYWNrX3R5cGU9UGFja1R5cGUuUGFja1R5cGVDTUQsCiAgICAgICAgZGF0YT1iIiIsCiAgICAgICAgb3Bjb2RlPU5vbmUsCiAgICAgICAgcmVjb3JkX3R5cGU9Tm9uZSwKICAgICAgICByZWNvcmRfZGF0YT1Ob25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHBhY2tfdHlwZSwgZGF0YSwgb3Bjb2RlKQogICAgICAgIHNlbGYucmVjb3JkX3R5cGVfID0gcmVjb3JkX3R5cGUKICAgICAgICBzZWxmLnJlY29yZF9kYXRhXyA9IHJlY29yZF9kYXRhCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAicGFja190eXBlOiB7fSwgb3Bjb2RlOiB7fSwgcmVjb3JkX3R5cGU6IHt9LCByZWNvcmQgZGF0YToge30iLmZvcm1hdCgKICAgICAgICAgICAgc2VsZi5wYWNrX3R5cGVfLCBzZWxmLm9wY29kZV8sIHNlbGYucmVjb3JkX3R5cGVfLCBzZWxmLnJlY29yZF9kYXRhXwogICAgICAgICkKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBwYWNrKAogICAgICAgIGNscywKICAgICAgICBvcGNvZGU6IE9wY29kZSwKICAgICAgICByZWNvcmRfdHlwZTogUmVjb3JkVHlwZSwKICAgICAgICByZWNvcmQ9YiIiLAogICAgKToKICAgICAgICByZWNvcmRfY29udGVudF9sZW5ndGggPSBsZW4ocmVjb3JkKQoKICAgICAgICBwYWNrZXQgPSBiIiIKICAgICAgICBwYWNrZXQgKz0gUGFja0NvbnRlbnQuTWFnaWMKICAgICAgICBwYWNrZXQgKz0gc3RydWN0LnBhY2soIkIiLCBvcGNvZGUudmFsdWUpCiAgICAgICAgcGFja2V0ICs9IHN0cnVjdC5wYWNrKCJCIiwgcmVjb3JkX3R5cGUudmFsdWUpCiAgICAgICAgIyBwYWNrZXQgKz0gc3RydWN0LnBhY2soIjxRIiwgcmVjb3JkX2NvbnRlbnRfbGVuZ3RoKSAgIyA8USDooajnpLrlsI/nq6/ml6DnrKblj7c2NOS9jeaVtOaVsAogICAgICAgIHBhY2tldCArPSBzdHJ1Y3QucGFjaygiPkkiLCByZWNvcmRfY29udGVudF9sZW5ndGgpICAjID5JIOihqOekuuWkp+err+aXoOespuWPtzMy5L2N5pW05pWwCiAgICAgICAgcGFja2V0ICs9IHN0cnVjdC5wYWNrKCJCIiwgMCkKICAgICAgICBwYWNrZXQgKz0gc3RydWN0LnBhY2soIkIiLCAwKQogICAgICAgICMgcGFja2V0ICs9IHN0cnVjdC5wYWNrKCJCIiwgMCkKICAgICAgICAjIHBhY2tldCArPSBzdHJ1Y3QucGFjaygiQiIsIDApCiAgICAgICAgdG9xdWVfdmFsdWUgPSA4MAogICAgICAgIHBhY2tldCArPSBzdHJ1Y3QucGFjaygiPkgiLCB0b3F1ZV92YWx1ZSkgICMgYidceDAxXHhmNCcKICAgICAgICBwYWNrZXQgKz0gcmVjb3JkCiAgICAgICAgcGFja2V0ICs9IHN0cnVjdC5wYWNrKCJCIiwgMCkKICAgICAgICBwYWNrZXQgKz0gc3RydWN0LnBhY2soIkIiLCAxKQogICAgICAgIHBhY2tldCArPSBQYWNrQ29udGVudC5NYWdpYwoKICAgICAgICByZXR1cm4gQ21kUGFjaygKICAgICAgICAgICAgZGF0YT1wYWNrZXQsIG9wY29kZT1vcGNvZGUsIHJlY29yZF9kYXRhPXJlY29yZCwgcmVjb3JkX3R5cGU9cmVjb3JkX3R5cGUKICAgICAgICApCiAgICAKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHBhY2tfY2FsaWIoCiAgICAgICAgY2xzLAogICAgICAgIHJlY29yZD1iIiIsCiAgICApOgogICAgICAgIHJlY29yZF9jb250ZW50X2xlbmd0aCA9IGxlbihyZWNvcmQpCgogICAgICAgIHBhY2tldCA9IGIiIgogICAgICAgIHBhY2tldCArPSByZWNvcmQKCiAgICAgICAgcmV0dXJuIENtZFBhY2soCiAgICAgICAgICAgIGRhdGE9cGFja2V0LCBvcGNvZGU9Tm9uZSwgcmVjb3JkX2RhdGE9cmVjb3JkLCByZWNvcmRfdHlwZT1Ob25lCiAgICAgICAgKQogICAgCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiB1bnBhY2soY2xzLCBkYXRhOiBieXRlcykgLT4gIkNtZFBhY2siOgogICAgICAgIGlmIG5vdCBjbHMuY2hlY2tfaGVhZChkYXRhKSBvciBub3QgY2xzLmNoZWNrX3RhaWwoZGF0YSk6CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgICMg6K6h566X5pWw5o2u5YyF5ZCE6YOo5YiG55qE5L2N572uCiAgICAgICAgbWFnaWNfbGVuID0gbGVuKFBhY2tDb250ZW50Lk1hZ2ljKQogICAgICAgIGhlYWRlcl9lbmQgPSBtYWdpY19sZW4KICAgICAgICBvcGNvZGVfcG9zID0gaGVhZGVyX2VuZAogICAgICAgIHJlY29yZF90eXBlX3BvcyA9IG9wY29kZV9wb3MgKyAxCiAgICAgICAgbGVuZ3RoX3BvcyA9IHJlY29yZF90eXBlX3BvcyArIDEKICAgICAgICByZWNvcmRfc3RhcnQgPSBsZW5ndGhfcG9zICsgOAogICAgICAgIHJlY29yZF9lbmQgPSAtbWFnaWNfbGVuCgogICAgICAgIG9wY29kZV92YWx1ZSA9IGRhdGFbb3Bjb2RlX3Bvc10KICAgICAgICByZWNvcmRfdHlwZV92YWx1ZSA9IGRhdGFbcmVjb3JkX3R5cGVfcG9zXQogICAgICAgIHJlY29yZF9jb250ZW50X2xlbmd0aCA9IHN0cnVjdC51bnBhY2soIjxRIiwgZGF0YVtsZW5ndGhfcG9zIDogbGVuZ3RoX3BvcyArIDhdKVsKICAgICAgICAgICAgMAogICAgICAgIF0KICAgICAgICByZWNvcmRfZGF0YSA9IGRhdGFbcmVjb3JkX3N0YXJ0OnJlY29yZF9lbmRdCgogICAgICAgIGlmIGxlbihyZWNvcmRfZGF0YSkgIT0gcmVjb3JkX2NvbnRlbnRfbGVuZ3RoOgogICAgICAgICAgICBwcmludCgiRVJST1IhIHJlY29yZCBkYXRhIGxlbmd0aCBub3QgbWF0Y2ghIikKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvcGNvZGUgPSBPcGNvZGUob3Bjb2RlX3ZhbHVlKQogICAgICAgICAgICByZWNvcmRfdHlwZSA9IFJlY29yZFR5cGUocmVjb3JkX3R5cGVfdmFsdWUpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3IgYXMgZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgcmV0dXJuIENtZFBhY2soCiAgICAgICAgICAgIGRhdGE9ZGF0YSwgb3Bjb2RlPW9wY29kZSwgcmVjb3JkX3R5cGU9cmVjb3JkX3R5cGUsIHJlY29yZF9kYXRhPXJlY29yZF9kYXRhCiAgICAgICAgKQoKCmNsYXNzIE1lc3NhZ2VQYWNrKFBhY2spOgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgcGFja190eXBlPVBhY2tUeXBlLlBhY2tUeXBlTWVzc2FnZSwKICAgICAgICBkYXRhPWIiIiwKICAgICAgICBvcGNvZGU9Tm9uZSwKICAgICAgICByZWNvcmRzOiBMaXN0W1JlY29yZF0gPSBbXSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhwYWNrX3R5cGUsIGRhdGEsIG9wY29kZSkKICAgICAgICBzZWxmLnJlY29yZHNfID0gcmVjb3JkcwoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gInBhY2tfdHlwZToge30sIG9wY29kZToge30sIHJlY29yZHM6IFxuIHt9Ii5mb3JtYXQoCiAgICAgICAgICAgIHNlbGYucGFja190eXBlXywgc2VsZi5vcGNvZGVfLCBzZWxmLnJlY29yZHNfCiAgICAgICAgKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHBhY2soCiAgICAgICAgY2xzLAogICAgICAgIG9wY29kZTogT3Bjb2RlLAogICAgICAgIHJlY29yZHM6IExpc3RbUmVjb3JkXSA9IFtdLAogICAgKToKCiAgICAgICAgcGFja2V0ID0gYiIiCiAgICAgICAgcGFja2V0ICs9IFBhY2tDb250ZW50Lk1hZ2ljCiAgICAgICAgcGFja2V0ICs9IHN0cnVjdC5wYWNrKCJCIiwgb3Bjb2RlLnZhbHVlKQoKICAgICAgICBmb3IgcmVjb3JkIGluIHJlY29yZHM6CiAgICAgICAgICAgIHBhY2tldCArPSBzdHJ1Y3QucGFjaygiQiIsIHJlY29yZC5yZWNvcmRfdHlwZS52YWx1ZSkKICAgICAgICAgICAgcGFja2V0ICs9IHN0cnVjdC5wYWNrKAogICAgICAgICAgICAgICAgIjxRIiwgcmVjb3JkLnJlY29yZF9jb250ZW50X2xlbmd0aAogICAgICAgICAgICApICAjIDxRIOihqOekuuWwj+err+aXoOespuWPtzY05L2N5pW05pWwCiAgICAgICAgICAgIHBhY2tldCArPSByZWNvcmQucmVjb3JkX2RhdGEKCiAgICAgICAgcGFja2V0ICs9IFBhY2tDb250ZW50Lk1hZ2ljCiAgICAgICAgcmV0dXJuIHBhY2tldAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHVucGFjayhjbHMsIGRhdGE6IGJ5dGVzKSAtPiAiTWVzc2FnZVBhY2siOgogICAgICAgIHRyeToKICAgICAgICAgICAgcHJpbnQoInVucGFjayBkYXRhOiB7fSIuZm9ybWF0KGRhdGEuaGV4KCkpKQogICAgICAgICAgICBpZiBub3QgY2xzLmNoZWNrX2hlYWQoZGF0YSkgb3Igbm90IGNscy5jaGVja190YWlsKGRhdGEpOgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgICAgIHJlY29yZHM6IExpc3RbUmVjb3JkXSA9IFtdCgogICAgICAgICAgICBtYWdpY19sZW4gPSBsZW4oUGFja0NvbnRlbnQuTWFnaWMpCiAgICAgICAgICAgIGhlYWRlcl9lbmQgPSBtYWdpY19sZW4KICAgICAgICAgICAgb3Bjb2RlX3BvcyA9IGhlYWRlcl9lbmQKCiAgICAgICAgICAgIGkgPSBvcGNvZGVfcG9zICsgMQogICAgICAgICAgICBvcGNvZGVfdmFsdWUgPSBkYXRhW29wY29kZV9wb3NdCgogICAgICAgICAgICBkYXRhX2VuZCA9IGxlbihkYXRhKSAtIG1hZ2ljX2xlbgogICAgICAgICAgICB3aGlsZSBpIDwgZGF0YV9lbmQ6CiAgICAgICAgICAgICAgICByZWNvcmRfdHlwZV9wb3MgPSBpCiAgICAgICAgICAgICAgICByZWNvcmRfdHlwZV92YWx1ZSA9IGRhdGFbcmVjb3JkX3R5cGVfcG9zXQogICAgICAgICAgICAgICAgbGVuZ3RoX3BvcyA9IHJlY29yZF90eXBlX3BvcyArIDEKICAgICAgICAgICAgICAgIHJlY29yZF9jb250ZW50X2xlbmd0aCA9IHN0cnVjdC51bnBhY2soCiAgICAgICAgICAgICAgICAgICAgIj5RIiwgZGF0YVtsZW5ndGhfcG9zIDogbGVuZ3RoX3BvcyArIDhdCiAgICAgICAgICAgICAgICApWzBdCgogICAgICAgICAgICAgICAgcmVjb3JkX3N0YXJ0ID0gbGVuZ3RoX3BvcyArIDgKICAgICAgICAgICAgICAgIHJlY29yZF9lbmQgPSByZWNvcmRfc3RhcnQgKyByZWNvcmRfY29udGVudF9sZW5ndGgKICAgICAgICAgICAgICAgIHJlY29yZF9kYXRhID0gZGF0YVtyZWNvcmRfc3RhcnQ6cmVjb3JkX2VuZF0KCiAgICAgICAgICAgICAgICByZWNvcmRzLmFwcGVuZChSZWNvcmQoUmVjb3JkVHlwZShyZWNvcmRfdHlwZV92YWx1ZSksIHJlY29yZF9kYXRhKSkKCiAgICAgICAgICAgICAgICBpID0gcmVjb3JkX2VuZAoKICAgICAgICAgICAgcmV0dXJuIE1lc3NhZ2VQYWNrKGRhdGE9ZGF0YSwgb3Bjb2RlPU9wY29kZShvcGNvZGVfdmFsdWUpLCByZWNvcmRzPXJlY29yZHMpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiAgYXMgZToKICAgICAgICAgICAgdHJhY2ViYWNrLnByaW50X2V4YygpCiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdW5wYWNrX2NhbWVyYV9jYWxpYihjbHMsIGRhdGE6IGJ5dGVzKSAtPiAiTWVzc2FnZVBhY2siOgogICAgICAgIHRyeToKICAgICAgICAgICAgcHJpbnQoInVucGFjayBkYXRhOiB7fSIuZm9ybWF0KGRhdGEuaGV4KCkpKQogICAgICAgICAgICBpZiBub3QgY2xzLmNoZWNrX2hlYWQoZGF0YSkgb3Igbm90IGNscy5jaGVja190YWlsKGRhdGEpOgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgICAgIG1hZ2ljX2xlbiA9IGxlbihQYWNrQ29udGVudC5NYWdpYykKICAgICAgICAgICAgICAgICAgICAgICMgVGhlIHN0cnVjdHVyZSBzZWVtcyB0byBiZToKICAgICAgICAgICAgIyBbTWFnaWMgKDUpXSArIFtMZW5ndGggKDIsIEJpZyBFbmRpYW4pXSArIFtPcGNvZGUgKDEpXSArIFtQYXlsb2FkXSArIFtUYWlsIE1hZ2ljICg1KV0KICAgICAgICAgICAgIyBCYXNlZCBvbiB1c2VyIGlucHV0OiAnZGFzXHJcbicgKDUpICsgJ1x4MDFceDkxJyAoMikgKyAnXG4nICgxLCBPcGNvZGUgMHgwQSkgKyAuLi4KCiAgICAgICAgICAgIGxlbmd0aF9wb3MgPSBtYWdpY19sZW4KICAgICAgICAgICAgIyBSZWFkIDIgYnl0ZXMgbGVuZ3RoIChCaWcgRW5kaWFuIGJhc2VkIG9uIDB4MDE5MSA9IDQwMSkKICAgICAgICAgICAgcGF5bG9hZF9sZW5ndGggPSBzdHJ1Y3QudW5wYWNrKCI+SCIsIGRhdGFbbGVuZ3RoX3BvcyA6IGxlbmd0aF9wb3MgKyAyXSlbMF0KCiAgICAgICAgICAgIG9wY29kZV9wb3MgPSBsZW5ndGhfcG9zICsgMgogICAgICAgICAgICBvcGNvZGVfdmFsdWUgPSBkYXRhW29wY29kZV9wb3NdCgogICAgICAgICAgICAjIFBheWxvYWQgc3RhcnRzIGFmdGVyIE9wY29kZQogICAgICAgICAgICBwYXlsb2FkX3N0YXJ0ID0gb3Bjb2RlX3BvcyArIDEKICAgICAgICAgICAgIyBQYXlsb2FkIGVuZHMgYmVmb3JlIFRhaWwgTWFnaWMKICAgICAgICAgICAgIyBPciB3ZSBjYW4gdXNlIHRoZSBwYXJzZWQgbGVuZ3RoIHRvIGRldGVybWluZSBlbmQ/CiAgICAgICAgICAgICMgTGV0J3Mgc3RpY2sgdG8gdGhlIHN0cnVjdHVyZTogTWFnaWMgKyBMZW5ndGggKyBPcGNvZGUgKyBQYXlsb2FkICsgTWFnaWMKICAgICAgICAgICAgIyBUb3RhbCBsZW5ndGggY2hlY2s/CgogICAgICAgICAgICBwYXlsb2FkID0gZGF0YVtwYXlsb2FkX3N0YXJ0IDogLW1hZ2ljX2xlbl0KCiAgICAgICAgICAgICMgUGFyc2UgdGhlIHByb3RvYnVmLWxpa2UgcGF5bG9hZAogICAgICAgICAgICBjYWxpYl9pbmZvID0gY2xzLl9wYXJzZV9wcm90b2J1Zl9jYWxpYihwYXlsb2FkKQoKICAgICAgICAgICAgIyBHZW5lcmF0ZSBZQU1MIGNvbnRlbnQKICAgICAgICAgICAgeWFtbF9jb250ZW50ID0gY2xzLl9nZW5lcmF0ZV95YW1sKGNhbGliX2luZm8pCgogICAgICAgICAgICAjIEdlbmVyYXRlIFlBTUwgY29udGVudAogICAgICAgICAgICB5YW1sX2NvbnRlbnQgPSBjbHMuX2dlbmVyYXRlX3lhbWwoY2FsaWJfaW5mbykKICAgICAgICAgICAgcHJpbnQoInlhbWw6ICIsIHlhbWxfY29udGVudCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2NyaXB0X2RpciA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQogICAgICAgICAgICAgICAgd29ya3NwYWNlX2RpciA9IG9zLnBhdGguYWJzcGF0aChvcy5wYXRoLmpvaW4oc2NyaXB0X2RpciwgIi4uLy4uLy4uLyIpKQogICAgICAgICAgICAgICAgcmVzdWx0X2RpciA9IG9zLnBhdGguam9pbih3b3Jrc3BhY2VfZGlyLCAiY2FsaWJfcmVzdWx0IikKCiAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocmVzdWx0X2Rpcik6CiAgICAgICAgICAgICAgICAgICAgb3MubWFrZWRpcnMocmVzdWx0X2RpcikKCiAgICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ocmVzdWx0X2RpciwgImNhbTBfc2Vuc29yLnlhbWwiKQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKGZpbGVfcGF0aCwgInciKSBhcyBmOgogICAgICAgICAgICAgICAgICAgIGYud3JpdGUoeWFtbF9jb250ZW50KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludChmIkVycm9yIHNhdmluZyBjYWxpYnJhdGlvbiBmaWxlOiB7ZX0iKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHRyYWNlYmFjay5wcmludF9leGMoKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX3JlYWRfdmFyaW50KGRhdGEsIHBvcyk6CiAgICAgICAgcmVzdWx0ID0gMAogICAgICAgIHNoaWZ0ID0gMAogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIGlmIHBvcyA+PSBsZW4oZGF0YSk6CiAgICAgICAgICAgICAgICBwcmludChmInBvczoge3Bvc30sIGRhdGE6IHtkYXRhfSwgbGVuOiB7bGVuKGRhdGEpfSIpCiAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oIlZhcmludCBvdmVyZmxvdyIpCiAgICAgICAgICAgIGIgPSBkYXRhW3Bvc10KICAgICAgICAgICAgcG9zICs9IDEKICAgICAgICAgICAgcmVzdWx0IHw9IChiICYgMHg3ZikgPDwgc2hpZnQKICAgICAgICAgICAgaWYgbm90IChiICYgMHg4MCk6CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LCBwb3MKICAgICAgICAgICAgc2hpZnQgKz0gNwoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9wYXJzZV9wcm90b2J1Zl9jYWxpYihjbHMsIGRhdGEpOgogICAgICAgIHBvcyA9IDAKICAgICAgICBpbmZvID0gewogICAgICAgICAgICAid2lkdGgiOiAwLAogICAgICAgICAgICAiaGVpZ2h0IjogMCwKICAgICAgICAgICAgIm1vZGVsIjogIiIsCiAgICAgICAgICAgICJkaXN0b3J0aW9uIjogW10sCiAgICAgICAgICAgICJpbnRyaW5zaWNzIjogW10sCiAgICAgICAgICAgICJleHRyaW5zaWNzIjogW10sICAjIHR4LCB0eSwgdHosIHF4LCBxeSwgcXosIHF3CiAgICAgICAgfQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIHBvcyA8IGxlbihkYXRhKToKICAgICAgICAgICAgICAgIHRhZywgcG9zID0gY2xzLl9yZWFkX3ZhcmludChkYXRhLCBwb3MpCiAgICAgICAgICAgICAgICBmaWVsZF9udW0gPSB0YWcgPj4gMwogICAgICAgICAgICAgICAgd2lyZV90eXBlID0gdGFnICYgMHgwNwoKICAgICAgICAgICAgICAgIGlmIGZpZWxkX251bSA9PSAyIGFuZCB3aXJlX3R5cGUgPT0gNTogICMgV2lkdGggKEZpeGVkMzIpCiAgICAgICAgICAgICAgICAgICAgaW5mb1sid2lkdGgiXSA9IHN0cnVjdC51bnBhY2soIjxJIiwgZGF0YVtwb3MgOiBwb3MgKyA0XSlbMF0KICAgICAgICAgICAgICAgICAgICBwcmludCgiaW5mbyB3aWR0aDogIiwgaW5mb1sid2lkdGgiXSkKICAgICAgICAgICAgICAgICAgICBwb3MgKz0gNAogICAgICAgICAgICAgICAgZWxpZiBmaWVsZF9udW0gPT0gMyBhbmQgd2lyZV90eXBlID09IDU6ICAjIEhlaWdodCAoRml4ZWQzMikKICAgICAgICAgICAgICAgICAgICBpbmZvWyJoZWlnaHQiXSA9IHN0cnVjdC51bnBhY2soIjxJIiwgZGF0YVtwb3MgOiBwb3MgKyA0XSlbMF0KICAgICAgICAgICAgICAgICAgICBwcmludCgiaW5mbyBoZWlnaHQ6ICIsIGluZm9bImhlaWdodCJdKQogICAgICAgICAgICAgICAgICAgIHBvcyArPSA0CiAgICAgICAgICAgICAgICBlbGlmIGZpZWxkX251bSA9PSA0IGFuZCB3aXJlX3R5cGUgPT0gMjogICMgTW9kZWwgKFN0cmluZykKICAgICAgICAgICAgICAgICAgICBsZW5ndGgsIHBvcyA9IGNscy5fcmVhZF92YXJpbnQoZGF0YSwgcG9zKQogICAgICAgICAgICAgICAgICAgIGluZm9bIm1vZGVsIl0gPSBkYXRhW3BvcyA6IHBvcyArIGxlbmd0aF0uZGVjb2RlKCJ1dGYtOCIpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoImluZm8gbW9kZWw6ICIsIGluZm9bIm1vZGVsIl0pCiAgICAgICAgICAgICAgICAgICAgcG9zICs9IGxlbmd0aAogICAgICAgICAgICAgICAgZWxpZiBmaWVsZF9udW0gPT0gNSBhbmQgd2lyZV90eXBlID09IDI6ICAjIERpc3RvcnRpb24gQ29lZmZzIChQYWNrZWQgRG91YmxlcykKICAgICAgICAgICAgICAgICAgICBsZW5ndGgsIHBvcyA9IGNscy5fcmVhZF92YXJpbnQoZGF0YSwgcG9zKQogICAgICAgICAgICAgICAgICAgIGNvdW50ID0gbGVuZ3RoIC8vIDgKICAgICAgICAgICAgICAgICAgICBpbmZvWyJkaXN0b3J0aW9uIl0gPSBsaXN0KAogICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QudW5wYWNrKGYiPHtjb3VudH1kIiwgZGF0YVtwb3MgOiBwb3MgKyBsZW5ndGhdKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBwcmludCgiaW5mbyBkaXN0b3J0aW9uOiAiLCBpbmZvWyJkaXN0b3J0aW9uIl0pCiAgICAgICAgICAgICAgICAgICAgcG9zICs9IGxlbmd0aAogICAgICAgICAgICAgICAgZWxpZiBmaWVsZF9udW0gPT0gNiBhbmQgd2lyZV90eXBlID09IDI6ICAjIEludHJpbnNpY3MgTWF0cml4IChQYWNrZWQgRG91YmxlcykKICAgICAgICAgICAgICAgICAgICBsZW5ndGgsIHBvcyA9IGNscy5fcmVhZF92YXJpbnQoZGF0YSwgcG9zKQogICAgICAgICAgICAgICAgICAgIGNvdW50ID0gbGVuZ3RoIC8vIDgKICAgICAgICAgICAgICAgICAgICBpbmZvWyJpbnRyaW5zaWNzIl0gPSBsaXN0KAogICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QudW5wYWNrKGYiPHtjb3VudH1kIiwgZGF0YVtwb3MgOiBwb3MgKyBsZW5ndGhdKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBwcmludCgiaW5mbyBpbnRyaW5zaWNzOiAiLCBpbmZvWyJpbnRyaW5zaWNzIl0pCiAgICAgICAgICAgICAgICAgICAgcG9zICs9IGxlbmd0aAogICAgICAgICAgICAgICAgZWxpZiBmaWVsZF9udW0gPT0gMTAgYW5kIHdpcmVfdHlwZSA9PSAyOiAgIyBFeHRyaW5zaWNzIChQYWNrZWQgRG91YmxlcykKICAgICAgICAgICAgICAgICAgICBsZW5ndGgsIHBvcyA9IGNscy5fcmVhZF92YXJpbnQoZGF0YSwgcG9zKQogICAgICAgICAgICAgICAgICAgIGNvdW50ID0gbGVuZ3RoIC8vIDgKICAgICAgICAgICAgICAgICAgICBpbmZvWyJleHRyaW5zaWNzIl0gPSBsaXN0KAogICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QudW5wYWNrKGYiPHtjb3VudH1kIiwgZGF0YVtwb3MgOiBwb3MgKyBsZW5ndGhdKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBwcmludCgiaW5mbyBleHRyaW5zaWNzOiAiLCBpbmZvWyJleHRyaW5zaWNzIl0pCiAgICAgICAgICAgICAgICAgICAgcG9zICs9IGxlbmd0aAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjIFNraXAgdW5rbm93biBmaWVsZHMKICAgICAgICAgICAgICAgICAgICBpZiB3aXJlX3R5cGUgPT0gMDogICMgVmFyaW50CiAgICAgICAgICAgICAgICAgICAgICAgIF8sIHBvcyA9IGNscy5fcmVhZF92YXJpbnQoZGF0YSwgcG9zKQogICAgICAgICAgICAgICAgICAgIGVsaWYgd2lyZV90eXBlID09IDE6ICAjIEZpeGVkNjQKICAgICAgICAgICAgICAgICAgICAgICAgcG9zICs9IDgKICAgICAgICAgICAgICAgICAgICBlbGlmIHdpcmVfdHlwZSA9PSAyOiAgIyBMZW5ndGggRGVsaW1pdGVkCiAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aCwgcG9zID0gY2xzLl9yZWFkX3ZhcmludChkYXRhLCBwb3MpCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyArPSBsZW5ndGgKICAgICAgICAgICAgICAgICAgICBlbGlmIHdpcmVfdHlwZSA9PSAzOiAgIyBTdGFydCBHcm91cCAoRGVwcmVjYXRlZCkKICAgICAgICAgICAgICAgICAgICAgICAgIyBKdXN0IHNraXAgdGhlIHRhZywgaG9wZSB3ZSBjYW4gcGFyc2UgaW5uZXIgZmllbGRzIG9yIGZpbmQgRW5kIEdyb3VwCiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICBlbGlmIHdpcmVfdHlwZSA9PSA0OiAgIyBFbmQgR3JvdXAgKERlcHJlY2F0ZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICMgSnVzdCBza2lwIHRoZSB0YWcKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgIGVsaWYgd2lyZV90eXBlID09IDU6ICAjIEZpeGVkMzIKICAgICAgICAgICAgICAgICAgICAgICAgcG9zICs9IDQKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAjIFVua25vd24gd2lyZSB0eXBlLCBhYm9ydCBvciBicmVhawogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIlVua25vd24gd2lyZSB0eXBlIHt3aXJlX3R5cGV9IGF0IHBvcyB7cG9zfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIkVycm9yIHNhdmluZyBjYWxpYnJhdGlvbiBmaWxlOiB7ZX0iKSAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gaW5mbwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2VuZXJhdGVfeWFtbChpbmZvKToKICAgICAgICAjIE1hcCBtb2RlbCBuYW1lCiAgICAgICAgbW9kZWwgPSAia2I0IiBpZiBpbmZvWyJtb2RlbCJdID09ICJlcXVpZGlzdGFudCIgZWxzZSBpbmZvWyJtb2RlbCJdCgogICAgICAgICMgRXh0cmFjdCBpbnRyaW5zaWNzOiBbZngsIDAsIGN4LCAwLCBmeSwgY3ksIDAsIDAsIDFdIC0+IFtmeCwgZnksIGN4LCBjeV0KICAgICAgICBLID0gaW5mb1siaW50cmluc2ljcyJdCiAgICAgICAgaW50cmluc2ljcyA9IFtLWzBdLCBLWzRdLCBLWzJdLCBLWzVdXSBpZiBsZW4oSykgPj0gNiBlbHNlIFtdCgogICAgICAgICMgQ2FsY3VsYXRlIEV4dHJpbnNpY3MgTWF0cml4IFRfQlMKICAgICAgICAjIERhdGE6IHR4LCB0eSwgdHosIHF4LCBxeSwgcXosIHF3CiAgICAgICAgRSA9IGluZm9bImV4dHJpbnNpY3MiXQogICAgICAgIGlmIGxlbihFKSA+PSA3OgogICAgICAgICAgICB0eCwgdHksIHR6ID0gRVswXSwgRVsxXSwgRVsyXQogICAgICAgICAgICBxeCwgcXksIHF6LCBxdyA9IEVbM10sIEVbNF0sIEVbNV0sIEVbNl0KCiAgICAgICAgICAgICMgUXVhdGVybmlvbiB0byBSb3RhdGlvbiBNYXRyaXgKICAgICAgICAgICAgIyBSID0gWyAxLTJ5XjItMnpeMiwgMnh5LTJ6dywgICAgIDJ4eisyeXcgXQogICAgICAgICAgICAjICAgICBbIDJ4eSsyencsICAgICAxLTJ4XjItMnpeMiwgMnl6LTJ4dyBdCiAgICAgICAgICAgICMgICAgIFsgMnh6LTJ5dywgICAgIDJ5eisyeHcsICAgICAxLTJ4XjItMnleMiBdCgogICAgICAgICAgICB4eCwgeXksIHp6ID0gcXggKiBxeCwgcXkgKiBxeSwgcXogKiBxegogICAgICAgICAgICB4eSwgeHosIHl6ID0gcXggKiBxeSwgcXggKiBxeiwgcXkgKiBxegogICAgICAgICAgICB3eCwgd3ksIHd6ID0gcXcgKiBxeCwgcXcgKiBxeSwgcXcgKiBxegoKICAgICAgICAgICAgcjAwID0gMSAtIDIgKiAoeXkgKyB6eikKICAgICAgICAgICAgcjAxID0gMiAqICh4eSAtIHd6KQogICAgICAgICAgICByMDIgPSAyICogKHh6ICsgd3kpCgogICAgICAgICAgICByMTAgPSAyICogKHh5ICsgd3opCiAgICAgICAgICAgIHIxMSA9IDEgLSAyICogKHh4ICsgenopCiAgICAgICAgICAgIHIxMiA9IDIgKiAoeXogLSB3eCkKCiAgICAgICAgICAgIHIyMCA9IDIgKiAoeHogLSB3eSkKICAgICAgICAgICAgcjIxID0gMiAqICh5eiArIHd4KQogICAgICAgICAgICByMjIgPSAxIC0gMiAqICh4eCArIHl5KQoKICAgICAgICAgICAgdF9ic19kYXRhID0gWwogICAgICAgICAgICAgICAgcjAwLAogICAgICAgICAgICAgICAgcjAxLAogICAgICAgICAgICAgICAgcjAyLAogICAgICAgICAgICAgICAgdHgsCiAgICAgICAgICAgICAgICByMTAsCiAgICAgICAgICAgICAgICByMTEsCiAgICAgICAgICAgICAgICByMTIsCiAgICAgICAgICAgICAgICB0eSwKICAgICAgICAgICAgICAgIHIyMCwKICAgICAgICAgICAgICAgIHIyMSwKICAgICAgICAgICAgICAgIHIyMiwKICAgICAgICAgICAgICAgIHR6LAogICAgICAgICAgICAgICAgMC4wLAogICAgICAgICAgICAgICAgMC4wLAogICAgICAgICAgICAgICAgMC4wLAogICAgICAgICAgICAgICAgMS4wLAogICAgICAgICAgICBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdF9ic19kYXRhID0gWzEsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDFdCgogICAgICAgICMgRm9ybWF0IFlBTUwgc3RyaW5nCiAgICAgICAgeWFtbF9zdHIgPSAiIyBHZW5lcmFsIHNlbnNvciBkZWZpbml0aW9ucy5cbiIKICAgICAgICB5YW1sX3N0ciArPSAic2Vuc29yX3R5cGU6IGNhbWVyYVxuIgogICAgICAgIHlhbWxfc3RyICs9ICJjb21tZW50OiBEQVMgQ2FtZXJhIGNhbTBcblxuIgoKICAgICAgICB5YW1sX3N0ciArPSAiIyBTZW5zb3IgZXh0cmluc2ljcyB3cnQuIHRoZSBib2R5LWZyYW1lLlxuIgogICAgICAgIHlhbWxfc3RyICs9ICJUX0JTOlxuIgogICAgICAgIHlhbWxfc3RyICs9ICIgIGNvbHM6IDRcbiIKICAgICAgICB5YW1sX3N0ciArPSAiICByb3dzOiA0XG4iCiAgICAgICAgeWFtbF9zdHIgKz0gIiAgZGF0YTogWyIKICAgICAgICB5YW1sX3N0ciArPSAiLCAiLmpvaW4oZiJ7eDpnfSIgZm9yIHggaW4gdF9ic19kYXRhKQogICAgICAgIHlhbWxfc3RyICs9ICJdXG5cbiIKCiAgICAgICAgeWFtbF9zdHIgKz0gIiMgQ2FtZXJhIHNwZWNpZmljIGRlZmluaXRpb25zLlxuIgogICAgICAgIHlhbWxfc3RyICs9ICJyYXRlX2h6OiAzMFxuIgogICAgICAgIHlhbWxfc3RyICs9IGYicmVzb2x1dGlvbjogW3tpbmZvWyd3aWR0aCddfSwge2luZm9bJ2hlaWdodCddfV1cbiIKICAgICAgICB5YW1sX3N0ciArPSBmImNhbWVyYV9tb2RlbDoge21vZGVsfVxuIgogICAgICAgIHlhbWxfc3RyICs9ICgKICAgICAgICAgICAgImludHJpbnNpY3M6IFsiCiAgICAgICAgICAgICsgIiwgIi5qb2luKGYie3h9IiBmb3IgeCBpbiBpbnRyaW5zaWNzKQogICAgICAgICAgICArICJdICNmdSwgZnYsIGN1LCBjdlxuIgogICAgICAgICkKICAgICAgICB5YW1sX3N0ciArPSBmImRpc3RvcnRpb25fbW9kZWw6IHttb2RlbH1cbiIKICAgICAgICB5YW1sX3N0ciArPSAoCiAgICAgICAgICAgICJkaXN0b3J0aW9uX2NvZWZmaWNpZW50czogWyIKICAgICAgICAgICAgKyAiLCAiLmpvaW4oZiJ7eH0iIGZvciB4IGluIGluZm9bImRpc3RvcnRpb24iXSkKICAgICAgICAgICAgKyAiXSAjazEsIGsyLCBrMywgazRcbiIKICAgICAgICApCgogICAgICAgIHJldHVybiB5YW1sX3N0cgogICAgCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgY21kX2wgPSBDbWRQYWNrLnBhY2tfY2FsaWIocmVjb3JkPWIiY2FtZXJhcmwiKSAgIyByZWFkIGNhbWVyYSBsZWZ0IAoKICAgIGNtZF9jID0gQ21kUGFjay5wYWNrX2NhbGliKHJlY29yZD1iImNhbWVyYXJjIikKCiAgICBjbWRfciA9IENtZFBhY2sucGFja19jYWxpYihyZWNvcmQ9YiJjYW1lcmFyciIpCgogICAgIyBsX2NtZF9wYWNrID0gQ21kUGFjay51bnBhY2soZGF0YT1jbWRfbC5kYXRhKQogICAgIyBjX2NtZF9wYWNrID0gQ21kUGFjay51bnBhY2soZGF0YT1jbWRfbC5kYXRhKQogICAgIyByX2NtZF9wYWNrID0gQ21kUGFjay51bnBhY2soZGF0YT1jbWRfbC5kYXRhKQoKICAgICMgcHJpbnQobF9jbWRfcGFjaykKICAgICMgcHJpbnQoY19jbWRfcGFjaykKICAgICMgcHJpbnQocl9jbWRfcGFjaykKCiAgICBtc2dfcGFja19kYXRhID0gTWVzc2FnZVBhY2sucGFjaygKICAgICAgICBvcGNvZGU9T3Bjb2RlLlJlYWRCYXRjaCwKICAgICAgICByZWNvcmRzPVsKICAgICAgICAgICAgUmVjb3JkKHJlY29yZF90eXBlPVJlY29yZFR5cGUuVGFjdGlsZSwgcmVjb3JkX2RhdGE9YiJ0YWN0aWxlIiksCiAgICAgICAgICAgIFJlY29yZChyZWNvcmRfdHlwZT1SZWNvcmRUeXBlLkVuY29kZXIsIHJlY29yZF9kYXRhPWIiZW5jb2RlciIpLAogICAgICAgIF0sCiAgICApCgogICAgbXNnX3BhY2sgPSBNZXNzYWdlUGFjay51bnBhY2sobXNnX3BhY2tfZGF0YSkKICAgIHByaW50KG1zZ19wYWNrKQo=
'''

# 解码并执行
try:
    source_code = base64.b64decode(ENCODED_SOURCE).decode('utf-8')
    code = compile(source_code, 'pack.py', 'exec')
    
    import builtins
    globals_dict = {
        '__name__': '__main__',
        '__file__': __file__,
        '__package__': None,
        '__builtins__': builtins,
    }
    
    exec(code, globals_dict)
    
    # 导出非私有符号
    for key, value in globals_dict.items():
        if not key.startswith('_'):
            globals()[key] = value
except Exception as e:
    print(f"pack模块解码错误: {e}")
    raise
